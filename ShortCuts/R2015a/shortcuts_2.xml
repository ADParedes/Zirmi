<?xml version="1.0" encoding="utf-8"?>
<FAVORITESROOT version="2">
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   <title>My Shortcuts</title>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   <FAVORITECATEGORY>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <name>Help Browser Favorites</name>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   </FAVORITECATEGORY>

   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   


   
   
   
   
   
   
   
   
   
   

   
   
   
   

   
   
   


   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   <FAVORITECATEGORY>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 0 Load imaging metadata matfile</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 0</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
% Zirmi Module B0 Version 1.4 &#xD;
% Update: 2019-06-03  &#xD;
% USER: Andre Daniel Paredes &#xD;
% email: andre.paredes@ymail.com&#xD;
% Description:Script/shortcut creates loads Zirmi Module A metadata and confirms &#xD;
% with USER that the metadata is correct. Additionally identifies important&#xD;
% directories to addpath for function accessibility, loading mat files, &#xD;
% and for saving mat files and excel files.&#xD;
&#xD;
&#xD;
%% Close all/Clear Variables/Warning&#xD;
clear ; clc; close all;&#xD;
boo_pc                     =   ispc;&#xD;
disp                      ('Please Note the Following Warning : ')&#xD;
warning                   ('Zirmi A needs to be ran on experiment directory before proceeding')&#xD;
switch      boo_pc&#xD;
    case {1}&#xD;
        disp('Zirmi is Compatible with your PC')&#xD;
    otherwise&#xD;
        disp('Zirmi is not yet compatible with your MAC...YET.')&#xD;
end;&#xD;
pause                     (2)&#xD;
%% Computer System Identification&#xD;
!hostname&#xD;
hostname                    =   char( getHostName( java.net.InetAddress.getLocalHost ) );&#xD;
ip                          =   char( getHostAddress( java.net.InetAddress.getLocalHost ) );&#xD;
user                        =   getenv('UserName');    &#xD;
if strcmp(hostname,'ADP-Chicago'); %this is the desktop&#xD;
    disp('Did NOT select Labtop Directory')&#xD;
    boo_desktop             =   1; %manual save logic of computer type | "1" is Yes for this is desktop&#xD;
elseif strcmp(hostname,'ADPAREDES') %this is the labtop&#xD;
    disp('Selected Labtop Directory')&#xD;
    boo_desktop             =   0;&#xD;
else&#xD;
    boo_desktop              =   2;&#xD;
end;&#xD;
disp('END: Computer Identified')&#xD;
%% Directory Identifications          &#xD;
switch boo_desktop&#xD;
    case {1,0}&#xD;
        if exist('input_16bit')&#xD;
        else&#xD;
            input_16bit = 'C';&#xD;
                if input_16bit  =='C' &#xD;
                    disp('Selected Directory 1: Main Files for where you keep data')&#xD;
                    %str_Functions_str           = strcat('C:\Users\',user,'\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun');&#xD;
%                     str_ExtendedFunctions_str   = strcat('C:\Users\',user,'\OneDrive\m_Scripts\phagosight-master');  &#xD;
                    str_ProcessedData_str       = strcat('C:\Users\',user,'\OneDrive - University of Illinois at Chicago\PhD Work\PhD matlab\mpx');&#xD;
                    %---For the Zirmi Function Selection&#xD;
                    if strcmp(hostname,'ADPAREDES'); %this is the labtop, Formally known as 'LLIULM'&#xD;
                            str_Zfunctions_str           = strcat('C:\Users\',user,'\Documents\Dropbox\Zirmi\Script_E_Functions'); &#xD;
                    elseif strcmp(hostname,'ADP-Chicago'); %this is the desktop&#xD;
                            str_Zfunctions_str           = strcat('C:\Users\',user,'\Documents\Dropbox\Zirmi\Script_E_Functions');&#xD;
                    end;   &#xD;
                    str_Presumptuous            = str_ProcessedData_str;&#xD;
                    checkConfocal               = 1;&#xD;
                else&#xD;
                    disp('Nothing was Selected...genius')&#xD;
                end;&#xD;
        end;&#xD;
    otherwise&#xD;
        usb_dirs = {'D','E','F','G','H','J','K','L','M','N'};&#xD;
        count_usb = 0;&#xD;
        boo_usb   = 0;&#xD;
        while boo_usb ==0&#xD;
            count_usb = 1 + count_usb;&#xD;
            str_usb = strcat(usb_dirs{count_usb});&#xD;
            boo_usb = exist(strcat(str_usb,':\'),'dir');&#xD;
        end;&#xD;
        switch str_usb&#xD;
            case usb_dirs&#xD;
                input_16bit ='E'; &#xD;
                disp(strcat('Directory Supplementary 2: ADP External Drive ',.... &#xD;
                                    str_usb,':\ for where you keep data'))&#xD;
                str_Presumptuous            =strcat(str_usb,...&#xD;
                    ':\AndreDParedes\Paredes Data\Processed_mpx(.mat&amp;.tif)');&#xD;
                str_Zfunctions_str          =strcat(str_usb,...&#xD;
                    ':\AndreDParedes\Paredes Data\Zirmi Phagosight Scripts\Script_E_Functions');&#xD;
                str_phagosight_str          =strcat(str_usb,...&#xD;
                    ':\AndreDParedes\Paredes Data\Zirmi Phagosight Scripts\GoldenPhagosight');&#xD;
            otherwise&#xD;
                input_16bit ='NotADP';&#xD;
                disp('Hello Zirmi User')&#xD;
                disp('First we Need to Determine Directories')&#xD;
                str_Presumptuous            = uigetdir('*.mat*', 'Please Select Directory Where you keep Experiment .mat files');&#xD;
                str_Zfunctions_str          = uigetdir('*', 'Please Select Directory "Zirmi_E_Functions" ');&#xD;
                str_phagosight_str          = uigetdir('*', 'Please Select Directory of Phagosight Functions');&#xD;
        end;&#xD;
        addpath(genpath(str_phagosight_str))&#xD;
end;&#xD;
disp        ('END: Directory Selections')&#xD;
%% Find Folder with Registered input Parameters&#xD;
cd(str_Presumptuous)&#xD;
switch input_16bit&#xD;
    case{'C','NotADP','E'}&#xD;
    otherwise&#xD;
        disp('ADP you are using directory outside C Drive') &#xD;
        exp_folder      = uigetdir('*.mat*', 'Please select your uniquely Experiment .mat file');&#xD;
        cd(exp_folder)&#xD;
end;&#xD;
startingFolder      =  str_Presumptuous;&#xD;
defaultFileName     =  fullfile(startingFolder,'*.*');&#xD;
% [baseFileName,folder] =uiputfile(defaultFileName,'Just try to specify in a different folder - I dare you') %This is to Overwrite save on a file of choosing.&#xD;
% if baseFileName == 0&#xD;
%     % User Clicked the cancel button.&#xD;
%     return;&#xD;
% end;&#xD;
disp                   ('Note: Select the .mat file of the Experiment you wish to analyze')&#xD;
xFile               =  uigetfile('*.*', 'Pick unique Experiment ID MATLAB file (.mat) with Registration Parameters');&#xD;
load(xFile);&#xD;
temp_Xfolder        = xFile(1:5);&#xD;
xFolder             = strcat(cd,'\',temp_Xfolder);&#xD;
%-Determined ti_d risky way&#xD;
posnum              = length(PositionName);&#xD;
disp                ('Position#/Sampling Frequency Reference Sheet: 7/1; 8/1.08; 9;1.2; 10/1.4'); %ADP specific - not necessarily compatible for other users.&#xD;
display             ('END: Experimental Registration Parameters')&#xD;
%% Parameters of Interest&#xD;
POI.Parameter1              = 2^16-1;   %MaxPixelIntensity - BPP - dependent on Bits &#xD;
POI.Parameter2              = 1.64;     %Lateralpixelresolution  - micronsperpixel micronsPerPixel =1.660; %microns per pixel (512x512) BUT image is in 256x256 so reduced by 2   3.102&#xD;
POI.Parameter3              = 10;       %ZstepMicrons&#xD;
POI.Parameter4              = ti_d;     %SamplingFrequency&#xD;
POI.Parameter5              = t_plate;  %Minutes Post Injury of Image Start (MPI)&#xD;
POI.ParameterA              = 0.70;     %Trackability i.e Minum Cell Track length Thresholdper SM a.k.a MajorityTracksPercent=.70; %&lt;--HIGH% selection - ADP&#xD;
POI.Parameter_gtA           = 0.8;      %Trackability per GT&#xD;
POI.ParameterB              = 1;        %StaticLimit (1 provides best result)  i.e. 0.8519um. &#xD;
POI.ParameterC              = 65;       %Distance from Wound Margin for Standardizatin of Wound Region &#xD;
POI.ParameterS              = 100;      %Leukocyte Spatial Interval (150um)&#xD;
POI.ParameterZ              = znum;     %Number of Z Positions&#xD;
%- ADP Specific &#xD;
ADP.adp1            = hostname;&#xD;
ADP.adp2            = user; &#xD;
ADP.date            = date;&#xD;
ADP.boo1            = input_16bit;         % 'C' lets me know this is main confocal directory&#xD;
ADP.boo2            = boo_desktop;         % labtop or not labtop &#xD;
ADP.boo3            = NaN;                 % checkconfocal not done until S1&#xD;
ADP.boo4            = boo_pc;              % check to see if mac or PC&#xD;
%-Other Parameters&#xD;
POI.Parameter10a            = name;                 % str of unique Experiment name (batch imaging-set)&#xD;
POI.Parameter10b            = xFile;                % metadata file by Experiment (batch imaging-set)&#xD;
POI.Parameter10c            = xFolder;              % dir of Unique Experiment Processed data&#xD;
POI.Parameter10d            = NaN;                  % Position String Combined&#xD;
POI.Parameter10e            = str_Zfunctions_str;   % Zirmi_Script_E_Functions&#xD;
POI.Parameter11a            = length(PositionName); % val number of positions of this experiment group&#xD;
POI.Parameter11b            = PositionName;         % str of Position  numbers being analyzed&#xD;
POI.Parameter11c            = NaN;                  % str of Position  numbers being analyzed done S1&#xD;
POI.Parameter12             = get(0,'ScreenSize');  % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
POI.Parameter13             = valsPh2;              % This is complex array with all the BF images so I can easy access BF images&#xD;
%% -GUI for Metadata Inputs. (Diaglog Box)&#xD;
prompt                  = {'Enter Parameter1: MaxPixelIntensity:'...&#xD;
                            ,'Enter Parameter2: LateralPixelResolution:'...&#xD;
                            ,'Enter Parameter3: Z Pixel Resolution (um):'...&#xD;
                            ,'Enter Parameter4: SamplingFrequency(min):'...&#xD;
                            ,'Enter Parameter5: MPI - Image Start - Minutes post injury'...&#xD;
                            ,'Enter ParameterA: Trackability Threshold(%)'...&#xD;
                            ,'Enter ParameterB: StaticLimit (Pixel)'...&#xD;
                            ,'Enter ParameterC: Wound Margin Distance for Wound ROI (Pixel)'...&#xD;
                            ,'Enter ParameterS: Leukocyte S# from Following Distance Interval From wound(um):'...&#xD;
                            ,'Enter ParameterZ: # Z stacks:'};&#xD;
dlg_title               = 'Input Parameters';&#xD;
num_lines               = 1;&#xD;
defaultans              = {num2str(POI.Parameter1),num2str(POI.Parameter2),num2str(POI.Parameter3),num2str(POI.Parameter4),num2str(POI.Parameter5)...&#xD;
                            ,num2str(POI.ParameterA),num2str(POI.ParameterB),num2str(POI.ParameterC),num2str(POI.ParameterS),num2str(POI.ParameterZ)};&#xD;
answer                  = inputdlg(prompt,dlg_title,num_lines,defaultans);&#xD;
PARAMETERS.Parameter1              = str2num(answer{1}); % Bits per pixel (BPP)&#xD;
PARAMETERS.Parameter2              = str2num(answer{2}); % LateralPixelResolution&#xD;
PARAMETERS.Parameter3              = str2num(answer{3}); % Z pixel resolution&#xD;
PARAMETERS.Parameter4              = str2num(answer{4}); % Sampling Frequency&#xD;
PARAMETERS.Parameter5              = str2num(answer{5}); % MPI&#xD;
PARAMETERS.ParameterA              = str2num(answer{6}); % Trackability&#xD;
PARAMETERS.ParameterB              = str2num(answer{7}); % Static Ratio&#xD;
PARAMETERS.ParameterC              = str2num(answer{8}); % Static Ratio&#xD;
PARAMETERS.ParameterS              = str2num(answer{9}); % Spatial Intervals from wound&#xD;
PARAMETERS.ParameterZ              = str2num(answer{10}); % # Z stacks&#xD;
&#xD;
POI.Parameter1              = PARAMETERS.Parameter1;&#xD;
POI.Parameter2              = PARAMETERS.Parameter2;&#xD;
POI.Parameter3              = PARAMETERS.Parameter3;&#xD;
POI.Parameter4              = PARAMETERS.Parameter4;&#xD;
POI.Parameter5              = PARAMETERS.Parameter5;&#xD;
POI.ParameterA              = PARAMETERS.ParameterA;&#xD;
POI.ParameterB              = PARAMETERS.ParameterB;&#xD;
POI.ParameterC              = PARAMETERS.ParameterC;&#xD;
POI.ParameterS              = PARAMETERS.Parameter1;&#xD;
POI.ParameterZ              = PARAMETERS.Parameter1;&#xD;
&#xD;
disp(strcat('Registered Bits per Pixel (BPP):',num2str(PARAMETERS.Parameter1)))&#xD;
disp(strcat('Registered LateralPixelResolution(um/pixel):',num2str(PARAMETERS.Parameter2)))&#xD;
disp(strcat('Registered ZstepMicrons(um):',num2str(PARAMETERS.Parameter3)))&#xD;
disp(strcat('Registered Sampling Frequency:',num2str(PARAMETERS.Parameter4)))&#xD;
disp(strcat('Registered MPI (minutes) ):',num2str(PARAMETERS.Parameter5)))&#xD;
disp(strcat('Registered Trackability:',num2str(PARAMETERS.ParameterA)))&#xD;
disp(strcat('Registered StaticLimit:',num2str(PARAMETERS.ParameterB)))&#xD;
disp(strcat('Registered Spatial Intervals:',num2str(PARAMETERS.ParameterS)))&#xD;
disp(strcat('Registered Z stacks:',num2str(PARAMETERS.ParameterZ)))&#xD;
disp('NOT Saving...')&#xD;
%% append save pameters to current registered metadata&#xD;
% save(zfile,'PARAMETERS','POI','-append')&#xD;
fullFilename    =   fullfile(str_Presumptuous,xFile);&#xD;
message         =   sprintf('Your Registration Parameters have been loaded from:\n%s',fullFilename);&#xD;
msgbox(message);&#xD;
addpath(genpath(POI.Parameter10e),genpath(str_phagosight_str)); % ZIRMI E Functions directory&#xD;
clearvars -except POI PARAMETERS ADP&#xD;
display('FINISHED: S0_RegisteredMetadata.m ')</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 1 Phagosight Cell Tracking Analysis</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 1</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%%% ShortCut Zirmi 1&#xD;
 &#xD;
    cd(POI.Parameter10c) %cd(zfolder)&#xD;
    neutrophilAnalysis()&#xD;
            &#xD;
% inputName=input('What is the name?','s');&#xD;
</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 2 Load Phagosight Analysis handles</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 2</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%% Loading Keyhole modeled Tracks from Specific Experiment  &#xD;
%-- Updated 2017-11-16 --ADP &#xD;
%-- Updates (e.g. ABO20) &amp; Specific Position (e.g. P2)&#xD;
disp('START1: Only RUN after S1 script &amp; SA script')&#xD;
&#xD;
%% Identify COMPUTER  (added 2/12/2018)&#xD;
boo_pc                     =   ispc;&#xD;
disp                      ('Please Note the Following Warning : ')&#xD;
warning                   ('Zirmi A needs to be ran on experiment directory before proceeding')&#xD;
switch      boo_pc&#xD;
    case {1}&#xD;
        disp('Zirmi is Compatible with your PC')&#xD;
    otherwise&#xD;
        disp('Zirmi is not yet compatible with your MAC...YET.')&#xD;
end;&#xD;
pause                     (2)&#xD;
%%-Computer System Identification&#xD;
!hostname&#xD;
hostname                    =   char( getHostName( java.net.InetAddress.getLocalHost ) );&#xD;
ip                          =   char( getHostAddress( java.net.InetAddress.getLocalHost ) );&#xD;
user                        =   getenv('UserName');    &#xD;
if strcmp(hostname,'ADP-Chicago'); %this is the desktop&#xD;
    disp('Did NOT select Labtop Directory')&#xD;
    boo_desktop             =   1; %manual save logic of computer type | "1" is Yes for this is desktop&#xD;
elseif strcmp(hostname,'ADPAREDES') %this is the labtop&#xD;
    disp('Selected Labtop Directory')&#xD;
    boo_desktop             =   0;&#xD;
else&#xD;
    boo_desktop              =   2;&#xD;
end;&#xD;
&#xD;
ADP.adp1            = hostname;&#xD;
ADP.adp2            = user; &#xD;
ADP.date            = date;&#xD;
ADP.boo1            = 'C';                 % 'C' lets me know this is main confocal directory&#xD;
ADP.boo2            = boo_desktop;         % labtop or not labtop &#xD;
ADP.boo3            = NaN;                 % checkconfocal not done until S1&#xD;
ADP.boo4            = boo_pc;              % check to see if mac or PC&#xD;
&#xD;
disp('END: Computer Identified')&#xD;
&#xD;
&#xD;
%% Ensure Correct Directory&#xD;
cd(POI.Parameter10c )&#xD;
%-Selecting Specific Fish (Position e.g P0,P1,P2...) &#xD;
%-"P# Directory has Processed Data via PhagoSight&#xD;
SelectedFolder_str  = uigetdir;&#xD;
[pa5, name5, ext5]  = fileparts(SelectedFolder_str); %break up file name&#xD;
%-Move to Directory of Interest&#xD;
cd(pa5); cd(name5);&#xD;
len_dir             = length(dir);&#xD;
len_dir             = len_dir-2;&#xD;
cd(pa5)&#xD;
&#xD;
Parameter11c     = name5;&#xD;
Parameter13      = 2;%%% % input_v=input('What Frame?')    &lt;----------LOAD FROM THIS FRAME FOR EXAMPLE VISUALIZTION TIFS&#xD;
Parameter14      = 'y';% input_OorNoO=input('Does it need an O or not  y/n','s');&#xD;
%% Automatically Detecting .mat files of Interest&#xD;
%-Paramter14 distinguishes between mat_ORe files and mat_Re files &#xD;
%-Paramter14 may vary on PC vs mac.  NOte: Here Written with PC.&#xD;
if Parameter14=='n'&#xD;
    mat     ='_mat_';&#xD;
    Or      = strcat(Parameter11c,mat,'Or/T00001.mat');%'r/T00001.mat');&#xD;
    Re      = strcat(Parameter11c,mat,'Re/T00001.mat');&#xD;
    La      = strcat(Parameter11c,mat,'La/T00001.mat');&#xD;
    Ha      = strcat(Parameter11c,mat,'Ha/handles.mat');%'Ha/handles_ANDRE.mat'&#xD;
    ha2     = strcat(Parameter11c,mat,'Ha');&#xD;
elseif Parameter14=='y'&#xD;
    mat='_mat_O';&#xD;
    if Parameter13&gt;9&#xD;
        Or=strcat(Parameter11c,mat,'r/T000',num2str(Parameter13),'.mat');&#xD;
        Re=strcat(Parameter11c,mat,'Re/T000',num2str(Parameter13),'.mat');&#xD;
        La=strcat(Parameter11c,mat,'La/T000',num2str(Parameter13),'.mat');&#xD;
    else&#xD;
        Or=strcat(Parameter11c,mat,'r/T0000',num2str(Parameter13),'.mat');&#xD;
        Re=strcat(Parameter11c,mat,'Re/T0000',num2str(Parameter13),'.mat');&#xD;
        La=strcat(Parameter11c,mat,'La/T0000',num2str(Parameter13),'.mat');            &#xD;
    end;&#xD;
    Ha      = strcat(Parameter11c,mat,'Ha/handles.mat');&#xD;
    ha2     = strcat(Parameter11c,mat,'Ha');&#xD;
else&#xD;
    display('neither? Fine then i say YES')&#xD;
    Parameter14='y';&#xD;
    return&#xD;
end;&#xD;
%% loading .mat files of Interest from PhagoSight&#xD;
load(Or)&#xD;
load(Re)&#xD;
load(La)&#xD;
%% loading 'handles.mat'&#xD;
str_FolderNewHandles   = strcat(Parameter11c,mat,'Ha-new');&#xD;
Folder_newHandles      = exist(str_FolderNewHandles,'dir');&#xD;
if Folder_newHandles ~= 0&#xD;
    Ha_new=strcat(Parameter11c,mat,'Ha-new/handles.mat');&#xD;
    load(Ha_new)&#xD;
else&#xD;
    load(Ha)&#xD;
end;&#xD;
&#xD;
%% Update Parameters&#xD;
%- PhagoSight Specific Parameters&#xD;
ch_Ph2                          = handles.ChannelDistribution(4);&#xD;
PhagoSight.ch_Ph2               = ch_Ph2;&#xD;
ch_GFP                          = round(median(handles.ChannelDistribution(1):handles.ChannelDistribution(3)));&#xD;
PhagoSight.ch_GFP               = ch_GFP;&#xD;
%- move to example directory of current position in T0001&#xD;
cd(POI.Parameter10c); cd(Parameter11c); cd('T0002');&#xD;
%- Reloaded Parameteres&#xD;
PhagoSight.ParameterZ                  = length(dir('*GFP*'));&#xD;
POI.Parameter11c                = name5;&#xD;
&#xD;
%-Display Important Parameters&#xD;
chr1                        = 'Your Registered Parameters have been Updated for Experiment';&#xD;
chr2                        = POI.Parameter10a;&#xD;
chr3                        = 'Experiment Positon:';&#xD;
chr4                        = POI.Parameter11c;&#xD;
chr5                        = 'SamplingFrequency(frames/minute)';&#xD;
chr6                        = num2str(POI.Parameter4);&#xD;
chr7                        = 'Number of Z-Positions';&#xD;
chr8                        = num2str(PhagoSight.ParameterZ);&#xD;
message2                = sprintf([chr1 '\n' chr2 '\n' chr3 '\n' chr4 '\n' chr5 '\n' chr6...&#xD;
                                    '\n' chr7 '\n' chr8]);&#xD;
msgbox(message2);% --&gt; only works for futures --&gt;   set(gcf,'Name','DataIn','Position',[s(3)/1.5 1 s(3)/3  (s(4))/2])&#xD;
clearvars -except POI PARAMETERS ADP PhagoSight handles dataIn dataL dataR ch_GFP ch_Ph2&#xD;
disp('END: Updating Parameters')&#xD;
disp('NOT SAVING')&#xD;
POI.Parameter10d            = strcat(POI.Parameter10a,'_',POI.Parameter11c);&#xD;
disp('FINISHED')</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 3 Show Phagosight Analysis *** Req.</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 3</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
ch_PH2          = PhagoSight.ch_Ph2&#xD;
ch_GFP          = PhagoSight.ch_GFP&#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
micronsPerPixel = POI.Parameter2; %LateralPixelResolution %old % micronsPerPixel=1.550 %microns per pixel (512x512) BUT image is in 256x256 so reduced by 2   3.102 &#xD;
framesPerSec    = POI.Parameter4; %ti_d SamplingFrequency&#xD;
%%- Load Functions&#xD;
&#xD;
%%- Figures&#xD;
% figure(1);set(gcf,'Name','DataIn','Position',[s(3)/2 1 s(3)/2  (s(4))]); imagesc(dataIn(:,:,ch_GFP))&#xD;
%     figure(2);set(gcf,'Name','DataR'); imagesc(dataR(:,:,ch_GFP))&#xD;
    figure(3);set(gcf,'Name','dataL'); imshow(dataL(:,:,ch_GFP))&#xD;
&#xD;
&#xD;
figure(4);set(gcf,'Name','1  = highlights longer (in distance) branches');&#xD;
        plotTracks(handles,1,:,micronsPerPixel,framesPerSec);&#xD;
%     figure(4);set(gcf,'Name','1  = highlights longer (in distance) branches');&#xD;
%     plotTracks(handles,1,1,micronsPerPixel,framesPerSec);&#xD;
figure(5);set(gcf,'Name','2  = highlights faster branches');%,'Position',[s(3)/2 1 s(3)/2  (s(4)-100)]);&#xD;
        plotTracks(handles,2,:,micronsPerPixel,framesPerSec);        &#xD;
%     figure(6);set(gcf,'Name',' 9  = plot ONLY those branches crossing the present Frame');&#xD;
%         plotTracks(handles,9,:,micronsPerPixel,framesPerSec);&#xD;
%     figure(7);set(gcf,'Name','10 = with labels (numbers) for the tracks');&#xD;
%         plotTracks(handles,10,:,micronsPerPixel,framesPerSec); &#xD;
%     figure(8);set(gcf,'Name','4  = highlights shorter branches');&#xD;
%         plotTracks(handles,4,:,micronsPerPixel,framesPerSec);  &#xD;
%     figure(10);set(gcf,'Name','1  = Velocity','Position',[s(3)/2 1 s(3)/2  (s(4)-200)]);&#xD;
%         plotTrackStats(handles,10,:,micronsPerPixel,framesPerSec);&#xD;
% for i=1:19&#xD;
%     figure();&#xD;
%     plotTracks(handles,i,1,micronsPerPixel,framesPerSec); %1 is z stack&#xD;
% end;&#xD;
%% ******PhagoSight Refernce Sheet **************&#xD;
%   [-14:-1]    Will be the same options as the positive ones but with X,Y,Z&#xD;
%   [1:14]      Will plot the tracks with the following options for X,Y,T&#xD;
%                       1  = highlights longer (in distance) branches&#xD;
%                       2  = highlights faster branches&#xD;
%                       3  = highlights longer (in number of frames) branches&#xD;
%                       4  = highlights shorter branches&#xD;
%                       5  = highlights slower branches&#xD;
%                       6  = highlights smaller branches&#xD;
%                       7  = discard branches with small total distance, i.e. 30% of upper half average distance&#xD;
%                       8  = discard branches with less than 3 nodes&#xD;
%                       9  = plot ONLY those branches crossing the present Frame&#xD;
%                       10 = with labels (numbers) for the tracks&#xD;
%                       11 = all tracks in green&#xD;
%                       12 = all tracks in red&#xD;
%                       13 = top in red, bottom in green&#xD;
%                       14 = top in green, bottom in red&#xD;
%                       15 = plot [x,volume,time] as type 1&#xD;
%                       16 = plot [y,volume,time] as type 1&#xD;
%                       17 = Merge into plot [x,volume,time] one colour per handle&#xD;
%                       18 = Merge into plot [y,volume,time] one colour per handle&#xD;
%                       19 = Merge several separate handles, p</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 4 Trace Regions***</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 4</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%% Zirmi B4 (SHORTCUT) - Outline Wound region and notochord&#xD;
% Update 2019-06-10  Version 1.4&#xD;
% created by: Andre Daniel Paredes, PhD&#xD;
% email: andre.paredes@ymail.com&#xD;
%% Update 2019-06-10&#xD;
% When ch_Ph2 is selected incorrectly it can error.  &#xD;
% This portion is customized only for ADP experiment setup.&#xD;
switch ch_Ph2&#xD;
    case{8}&#xD;
    otherwise&#xD;
        ch_Ph2 = 8;&#xD;
        PhagoSight.ch_Ph2 = 8;&#xD;
end;&#xD;
%% Define variables&#xD;
Parameter15      = 2;%%% % input_v=input('What Frame?')    &lt;----------LOAD FROM THIS FRAME FOR EXAMPLE VISUALIZTION TIFS&#xD;
display('START2 EXPEDITE:  Performing Wound Region')% http://www.phagosight.org/NF/trackingManual4.php&#xD;
cd(POI.Parameter10c)&#xD;
handles.distMaps    = 0;&#xD;
pause(2)&#xD;
valsPh2             = POI.Parameter13 ;&#xD;
Parameter11d        = str2num(POI.Parameter11c(2:end)); &#xD;
switch ADP.boo2&#xD;
    case {0,1,2}&#xD;
        POI.Parameter11d    = Parameter11d+1; %ADP uses P0-P11 (so i need to +1)&#xD;
    otherwise &#xD;
        warning('Potential Error')&#xD;
        disp('Not calibrated for MACs, may not work')&#xD;
        POI.Parameter11d    = Parameter11d;&#xD;
end;&#xD;
%-Need 'valsPh2' ~= valsPH2&#xD;
if exist('valsPh2') %#ok&lt;EXIST&gt;&#xD;
    OriginalImg = valsPh2{POI.Parameter11d}{Parameter15}; % &#xD;
    checkConfocal=1;&#xD;
    valsPH2=valsPh2;&#xD;
else&#xD;
    OriginalImg = valsPH2{POI.Parameter11d}{Parameter15}; &#xD;
    checkConfocal=0;&#xD;
end;&#xD;
%%  *WoundGAP *Notochord Spatial Domains %update 2017/11/16&#xD;
%- Limitation Spatial Domains are not dynamically determined.  The are&#xD;
%- marked and assumed to be relatively accurate throughout imaging sessions.&#xD;
I=imadjust(OriginalImg);&#xD;
PH2_8bit = im2uint8(I);&#xD;
PH2_re = imresize(PH2_8bit, [256 256]); &#xD;
close all&#xD;
figure(1)&#xD;
if handles.rows&gt;300&#xD;
    imagesc(dataR(:,:,ch_Ph2))&#xD;
    I=OriginalImg;  %Using Frame 2&#xD;
else&#xD;
    imshow(PH2_re)&#xD;
    I=PH2_re;&#xD;
end;&#xD;
%- *Wound Gap Selection&#xD;
disp('USER OUTLINE TOOL: Please outline WOUND GAP in (double click to finish) ')&#xD;
wR1  = roipoly();&#xD;
&#xD;
OriginalImg2 = valsPH2{POI.Parameter11d}{(handles.numFrames-2)}; %Using second to last Frame&#xD;
optimalzstack=4;&#xD;
I2=imadjust(OriginalImg2);&#xD;
PH2_8bit = im2uint8(I2);&#xD;
PH2_re = imresize(PH2_8bit, [256 256]); &#xD;
close all&#xD;
figure(2)&#xD;
if handles.rows&gt;300&#xD;
    I2=OriginalImg2;&#xD;
    disp('here')&#xD;
else&#xD;
    I2=PH2_re;&#xD;
    disp('there')&#xD;
end;&#xD;
imagesc(I2);&#xD;
%- *Tip Notochord Selection&#xD;
disp('USER OUTLINE TOOL: Please outline tip of NOTOCHORD (double click to finish) ')&#xD;
wR2  = roipoly();&#xD;
woundRegion=wR1|wR2;&#xD;
close all&#xD;
color_bw_wR=imoverlay(I2,bwperim(woundRegion),[ 1 0 0]);&#xD;
figure(3);imagesc(color_bw_wR);set(gcf,'Name','DataIn','Position',[POI.Parameter12(3)/1.5 1 POI.Parameter12(3)/3  (POI.Parameter12(4))/2])&#xD;
%- Save in Structure Array&#xD;
PhagoSight.wR1          = wR1;&#xD;
PhagoSight.wR2          = wR2;&#xD;
PhagoSight.woundRegion  = woundRegion;&#xD;
%% Once this wound region has been selected it is passed as a variable&#xD;
%- to the following functions&#xD;
handles                 = effectiveDistance(handles,woundRegion);&#xD;
%- To calculate the maps&#xD;
handles                 = effectiveTracks(handles,woundRegion);&#xD;
%- Viualised with the command "mesh"&#xD;
figure(4);set(gcf,'Name','DataIn','Position',[POI.Parameter12(3)/1.5 1 POI.Parameter12(3)/3  (POI.Parameter12(4))/2])&#xD;
mesh(handles.distMaps.oriDistMap)&#xD;
displayActivationPoint(handles,dataR(:,:,optimalzstack));&#xD;
dataR_WR                = dataR(:,:,ch_GFP).*(1-imdilate(zerocross(woundRegion),ones(3)));&#xD;
&#xD;
disp('END:Normalizing Spatial Parameters &amp; Wound Region')&#xD;
%%&#xD;
pause();&#xD;
close all&#xD;
ADP.boo3                        = checkConfocal;&#xD;
clearvars -except woundRegion POI PARAMETERS ADP PhagoSight handles dataIn dataL dataR ch_GFP ch_Ph2 hPlotNet&#xD;
disp('FINISHED: B3_SelectingReformattedPreProcessedData - Wound Region')&#xD;
</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 5A Plot Tracks over BF</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 5</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
ch_PH2          = PhagoSight.ch_Ph2;&#xD;
ch_GFP          = PhagoSight.ch_GFP;&#xD;
&#xD;
figure(10000);set(gcf,'Name','Speed Fast','Position',[s(3)/2 1 s(3)/2  (s(4))]);&#xD;
hplotTracks       = plotTracks(handles,-2); &#xD;
%  colorbar()&#xD;
%  plotTracks(handles,2,:,micronsPerPixel,framesPerSec);&#xD;
[XX,YY]= meshgrid((1:handles.cols),(1:handles.rows));&#xD;
ZZ = 1 * ones(handles.rows,handles.cols);&#xD;
surf(XX,YY,ZZ,dataR(:,:,ch_PH2),'edgecolor','none')&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
&#xD;
%axis([1 handles.cols 1 handles.rows 1 handles.numFrames])&#xD;
axis([1 handles.cols 1 handles.rows 1 handles.ChannelDistribution(2)])&#xD;
 colormap(gray)&#xD;
view(40,30)&#xD;
&#xD;
&#xD;
% colormap(gray.^(1/2))&#xD;
% colormap(gray.^2)&#xD;
figure(20000);set(gcf,'Name','Total Distance','Position',[s(3)/2 1 s(3)/2  (s(4))]);&#xD;
hplotTracks       = plotTracks(handles,1); %10 is label &#xD;
%  plotTracks(handles,2,:,micronsPerPixel,framesPerSec);&#xD;
[XX,YY]= meshgrid((1:handles.cols),(1:handles.rows));&#xD;
ZZ = 1 * ones(handles.rows,handles.cols);&#xD;
surf(XX,YY,ZZ,dataR(:,:,ch_PH2),'edgecolor','none')&#xD;
&#xD;
&#xD;
axis([1 handles.cols 1 handles.rows 1 handles.numFrames])&#xD;
colormap(gray)&#xD;
view(40,30)&#xD;
&#xD;
&#xD;
%  colormap(gray.^(1/10))&#xD;
   colormap(gray.^2)</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 5B Plot Tracks over ROS HM</label>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 5</icon>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
ch_PH2          = PhagoSight.ch_Ph2;&#xD;
ch_GFP          = PhagoSight.ch_GFP;&#xD;
woundRegion     = PhagoSight.woundRegion;&#xD;
checkConfocal   = ADP.boo3;&#xD;
BF              = dataR(:,:,handles.ChannelDistribution(3));&#xD;
TR              = dataR(:,:,6);&#xD;
if checkConfocal==1;&#xD;
    ch_PH2          = handles.ChannelDistribution(4);&#xD;
%     minValue=10000;&#xD;
%     maxValue=40000;&#xD;
    minValue        = 5000;&#xD;
    maxValue        = 20000;&#xD;
else&#xD;
    ch_PH2=5;&#xD;
    minValue        = 2500;&#xD;
    maxValue        = 5000;&#xD;
end;&#xD;
&#xD;
I_blurTR    = imguidedfilter(dataR(:,:,ch_PH2));&#xD;
clims       = [minValue maxValue];&#xD;
figure(10000);set(gcf,'Name','Over PH2');  &#xD;
imagesc(I_blurTR,clims);axis off; hold on;&#xD;
        colormap(jet) %// example colormap with 4 colors.&#xD;
%         colormap(summer)&#xD;
        cmap    = colormap;&#xD;
        hcb     = colorbar('southoutside');&#xD;
        title('ROS Generation','FontSize',20);&#xD;
hplotTracks = plotTracks(handles,11);&#xD;
[XX,YY]     = meshgrid((1:handles.cols),(1:handles.rows));&#xD;
ZZ          = 1 * ones(handles.rows,handles.cols);&#xD;
surf(XX,YY,ZZ,dataR(:,:,ch_PH2),'edgecolor','none')&#xD;
&#xD;
axis([1 handles.cols 1 handles.rows 1 handles.numFrames])&#xD;
% colormap(bone)&#xD;
view(40,30)&#xD;
%  colorbar('off')&#xD;
selectNeutrophilsM(gcf,handles,woundRegion)&#xD;
% colormap(gray.^(1/2))&#xD;
% colormap(gray.^2)&#xD;
</callback>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi 6  Phagosight Tracks HM Video</label>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 6</icon>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%Select folder with handles&#xD;
input_16bit     = ADP.boo1;&#xD;
name            = POI.Parameter10a;&#xD;
name5           = POI.Parameter11c;&#xD;
str_Presumptious= POI.Parameter10c;&#xD;
&#xD;
%%&#xD;
cd(str_Presumptious)&#xD;
disp(name5)&#xD;
disp(name)&#xD;
SelectedFolder_str=uigetdir&#xD;
[pa5, name5, ext5] = fileparts(SelectedFolder_str); %break up file name&#xD;
cd(SelectedFolder_str)&#xD;
disp(name5)&#xD;
disp(name)&#xD;
%% &#xD;
inputType=input('What is the number?');&#xD;
plotNeutrophilMovie(cd,inputType);</callback>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label> Zirmi 7 Save altered handles</label>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Number 7</icon>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%Save over handles.mat  -- not create a new handles.  &#xD;
%Note: Cannot undo  - Update 2017-12-11&#xD;
%Andre Daniel Paredes &#xD;
input_16bit     = ADP.boo1;&#xD;
name            = POI.Parameter10a;&#xD;
name5           = POI.Parameter11c;&#xD;
zfolder         = POI.Parameter10c;  &#xD;
woundRegion     = PhagoSight.woundRegion;&#xD;
%% if you want to save directly over current mat&#xD;
disp('Save Directly over Current Handles- just select folder it is currently in')&#xD;
disp(name5)&#xD;
disp(name)&#xD;
if exist('input_16bit')&#xD;
else&#xD;
    input_16bit='C' %automatically make Confocal- since I will be processing a grip.  2/10/2017&#xD;
%     input_16bit=input('y for 16bit else for not..is it for 16bit? E for external or C for confocal','s');&#xD;
    if input_16bit=='y'     %16 bit images for Matlab R2015a academic version&#xD;
        str_Presumptious            ='C:\Users\AndreDaniel\Documents\SkyDrive\PHD\Prelim\VisualBasic\Z-Stack\Zebrafish -16bit';&#xD;
    elseif input_16bit=='n' %8-bit (reduced images from Matlab R2013b academic version)&#xD;
        str_Presumptious            ='C:\Users\AndreDaniel\Documents\SkyDrive\PHD\Prelim\VisualBasic\Z-Stack\Zebrafish';&#xD;
    elseif input_16bit=='E'  %External Drive&#xD;
       str_ProcessedData_str        ='E:\';&#xD;
       str_Presumptious             =str_ProcessedData_str;&#xD;
        str_Experiment_str          = 'E:\'; %Experiment Folder- Starting Point to find Experiment to Analyze&#xD;
        str_Functions_str           ='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'; %Functions Folder-Upload Functions Andre Created&#xD;
        str_RawData_str             ='E:\';&#xD;
    elseif input_16bit=='C' &#xD;
        %Now interchangable (same for LLIULM &amp; ADP-Chicago)&#xD;
        str_ExtendedFunctions_str   =strcat('C:\Users\',user,'\OneDrive\m_Scripts\phagosight-master');  &#xD;
        str_ProcessedData_str       =strcat('C:\Users\',user,'\OneDrive\MrBigTest\Confocal Data\Processed Data');&#xD;
        if strcmp(hostname,'LLIULM'); %this is the desktop,'LLIULM'&#xD;
            str_Functions_str           = strcat('C:\Users\',user,'\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'); %Functions Folder-Upload Functions Andre Created&#xD;
        elseif strcmp(hostname,'ADP-Chicago'); %this is the desktop&#xD;
            str_Functions_str='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun';&#xD;
        end; &#xD;
        str_Presumptious             =str_ProcessedData_str;&#xD;
        checkConfocal=1;&#xD;
        disp(t_plate)&#xD;
        disp('*************ADJUST t_plate**********************')&#xD;
    end;&#xD;
&#xD;
end;&#xD;
cd(zfolder)&#xD;
Folderget=uigetdir&#xD;
cd(Folderget)&#xD;
&#xD;
save ('handles.mat','handles','woundRegion');&#xD;
disp('FINISHED: SAVED "handles" in appropiate folder')</callback>
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zirmi X Save handles Andre</label>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
%%%Huge NOTE!! handles_Andre is before Manipulation!!!!&#xD;
%%THIS TO SAVE HANDLES_ANDRE one that has been shifted!!&#xD;
input_16bit     = ADP.boo1;&#xD;
name            = POI.Parameter10a;&#xD;
name5           = POI.Parameter11c;&#xD;
zfolder         = POI.Parameter10c;  &#xD;
%% As was&#xD;
disp('Save Directly over Current Handles- just select folder it is currently in')&#xD;
disp(name5)&#xD;
disp(name)&#xD;
disp('THIS HANDLES_ANDRE TO SAVE')&#xD;
disp('HANDLES ANDRE IS BEFORE MANIPULATED')&#xD;
&#xD;
if exist('input_16bit')&#xD;
else&#xD;
    input_16bit='C' %automatically make Confocal- since I will be processing a grip.  2/10/2017&#xD;
%     input_16bit=input('y for 16bit else for not..is it for 16bit? E for external or C for confocal','s');&#xD;
    if input_16bit=='y'     %16 bit images for Matlab R2015a academic version&#xD;
        str_Presumptious            ='C:\Users\AndreDaniel\Documents\SkyDrive\PHD\Prelim\VisualBasic\Z-Stack\Zebrafish -16bit';&#xD;
    elseif input_16bit=='n' %8-bit (reduced images from Matlab R2013b academic version)&#xD;
        str_Presumptious            ='C:\Users\AndreDaniel\Documents\SkyDrive\PHD\Prelim\VisualBasic\Z-Stack\Zebrafish';&#xD;
    elseif input_16bit=='E'  %External Drive&#xD;
       str_ProcessedData_str        ='E:\';&#xD;
       str_Presumptious             =str_ProcessedData_str;&#xD;
        str_Experiment_str          = 'E:\'; %Experiment Folder- Starting Point to find Experiment to Analyze&#xD;
        str_Functions_str           ='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'; %Functions Folder-Upload Functions Andre Created&#xD;
        str_RawData_str             ='E:\';&#xD;
    elseif input_16bit=='C' &#xD;
        %Now interchangable (same for LLIULM &amp; ADP-Chicago)&#xD;
        str_ExtendedFunctions_str   =strcat('C:\Users\',user,'\OneDrive\m_Scripts\phagosight-master');  &#xD;
        str_ProcessedData_str       =strcat('C:\Users\',user,'\OneDrive\MrBigTest\Confocal Data\Processed Data');&#xD;
        if strcmp(hostname,'LLIULM'); %this is the desktop,'LLIULM'&#xD;
            str_Functions_str           = strcat('C:\Users\',user,'\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'); %Functions Folder-Upload Functions Andre Created&#xD;
        elseif strcmp(hostname,'ADP-Chicago'); %this is the desktop&#xD;
            str_Functions_str='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun';&#xD;
        end; &#xD;
        str_Presumptious             =str_ProcessedData_str;&#xD;
        checkConfocal=1;&#xD;
        disp(t_plate)&#xD;
        disp('*************ADJUST t_plate**********************')&#xD;
    end;&#xD;
&#xD;
end;&#xD;
cd(zfolder)&#xD;
Folderget=uigetdir&#xD;
cd(Folderget)&#xD;
&#xD;
% save('handlesPreW.mat','handlesPreW');&#xD;
&#xD;
if exist('woundRegion')    &#xD;
    handles_ANDRE=handles;&#xD;
    save ('handles_ANDRE.mat','handles_ANDRE','woundRegion');&#xD;
else&#xD;
    disp('Andre Manipulated Not saved, Because Andre isnt wounded');&#xD;
end;&#xD;
&#xD;
</callback>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>ALT. Zirmi  Load handles Andre</label>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%% Loading Keyhole modeled Tracks from Specific Experiment  &#xD;
%-- Updated 2017-11-16 --ADP &#xD;
%-- Updates (e.g. ABO20) &amp; Specific Position (e.g. P2)&#xD;
disp('START1: Only RUN after S1 script &amp; SA script')&#xD;
%% Ensure Correct Directory&#xD;
cd(POI.Parameter10c )&#xD;
%-Selecting Specific Fish (Position e.g P0,P1,P2...) &#xD;
%-"P# Directory has Processed Data via PhagoSight&#xD;
SelectedFolder_str  = uigetdir;&#xD;
[pa5, name5, ext5]  = fileparts(SelectedFolder_str); %break up file name&#xD;
%-Move to Directory of Interest&#xD;
cd(pa5); cd(name5);&#xD;
len_dir             = length(dir);&#xD;
len_dir             = len_dir-2;&#xD;
cd(pa5);&#xD;
&#xD;
Parameter11c     = name5;&#xD;
Parameter15      = 2;%%% % input_v=input('What Frame?')    &lt;----------LOAD FROM THIS FRAME FOR EXAMPLE VISUALIZTION TIFS&#xD;
Parameter14      = 'y';% input_OorNoO=input('Does it need an O or not  y/n','s');&#xD;
%% Automatically Detecting .mat files of Interest&#xD;
%-Paramter14 distinguishes between mat_ORe files and mat_Re files &#xD;
%-Paramter14 may vary on PC vs mac.  NOte: Here Written with PC.&#xD;
if Parameter14=='n'&#xD;
    mat     ='_mat_';&#xD;
    Or      = strcat(Parameter11c,mat,'Or/T00001.mat');%'r/T00001.mat');&#xD;
    Re      = strcat(Parameter11c,mat,'Re/T00001.mat');&#xD;
    La      = strcat(Parameter11c,mat,'La/T00001.mat');&#xD;
    Ha      = strcat(Parameter11c,mat,'Ha/handles.mat');%'Ha/handles_ANDRE.mat'&#xD;
    ha2     = strcat(Parameter11c,mat,'Ha');&#xD;
elseif Parameter14=='y'&#xD;
    mat='_mat_O';&#xD;
    if Parameter15&gt;9&#xD;
        Or=strcat(Parameter11c,mat,'r/T000',num2str(Parameter15),'.mat');&#xD;
        Re=strcat(Parameter11c,mat,'Re/T000',num2str(Parameter15),'.mat');&#xD;
        La=strcat(Parameter11c,mat,'La/T000',num2str(Parameter15),'.mat');&#xD;
    else&#xD;
        Or=strcat(Parameter11c,mat,'r/T0000',num2str(Parameter15),'.mat');&#xD;
        Re=strcat(Parameter11c,mat,'Re/T0000',num2str(Parameter15),'.mat');&#xD;
        La=strcat(Parameter11c,mat,'La/T0000',num2str(Parameter15),'.mat');            &#xD;
    end;&#xD;
    Ha      = strcat(Parameter11c,mat,'Ha/handles_ANDRE.mat');&#xD;
    ha2     = strcat(Parameter11c,mat,'Ha');&#xD;
else&#xD;
    display('neither? Fine then i say YES')&#xD;
    Parameter14='y';&#xD;
    return&#xD;
end;&#xD;
%% loading .mat files of Interest from PhagoSight&#xD;
load(Or)&#xD;
load(Re)&#xD;
load(La)&#xD;
%% loading 'handles.mat'&#xD;
str_FolderNewHandles   = strcat(Parameter11c,mat,'Ha-new');&#xD;
Folder_newHandles      = exist(str_FolderNewHandles,'dir');&#xD;
if Folder_newHandles ~= 0&#xD;
    Ha_new=strcat(Parameter11c,mat,'Ha-new/handles.mat');&#xD;
    load(Ha_new)&#xD;
else&#xD;
    load(Ha)&#xD;
end;&#xD;
&#xD;
%% Update Parameters&#xD;
%- PhagoSight Specific Parameters&#xD;
ch_Ph2                          = handles.ChannelDistribution(4)-1;&#xD;
PhagoSight.ch_Ph2               = ch_Ph2;&#xD;
ch_GFP                          = round(median(handles.ChannelDistribution(1):handles.ChannelDistribution(3)));&#xD;
PhagoSight.ch_GFP               = ch_GFP;&#xD;
%- move to example directory of current position in T0001&#xD;
cd(POI.Parameter10c); cd(Parameter11c); cd('T0002');&#xD;
%- Reloaded Parameteres&#xD;
PhagoSight.ParameterZ                  = length(dir('*GFP*'));&#xD;
POI.Parameter11c                = name5;&#xD;
&#xD;
%-Display Important Parameters&#xD;
chr1                        = 'Your Registered Parameters have been Updated for Experiment';&#xD;
chr2                        = POI.Parameter10a;&#xD;
chr3                        = 'Experiment Positon:';&#xD;
chr4                        = POI.Parameter11c;&#xD;
chr5                        = 'SamplingFrequency(frames/minute)';&#xD;
chr6                        = num2str(POI.Parameter4);&#xD;
chr7                        = 'Number of Z-Positions';&#xD;
chr8                        = num2str(PhagoSight.ParameterZ);&#xD;
message2                    = sprintf([chr1 '\n' chr2 '\n' chr3 '\n' chr4 '\n' chr5 '\n' chr6...&#xD;
                                    '\n' chr7 '\n' chr8]);&#xD;
msgbox(message2);% --&gt; only works for futures --&gt;   set(gcf,'Name','DataIn','Position',[s(3)/1.5 1 s(3)/3  (s(4))/2])&#xD;
&#xD;
disp('END: Updating Parameters')&#xD;
&#xD;
clearvars -except POI PARAMETERS ADP PhagoSight handles dataIn dataL dataR ch_GFP ch_Ph2&#xD;
disp('SAVE handlesPreW!!!!!!')&#xD;
disp('NOW')</callback>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <name>Phagosight</name>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   </FAVORITECATEGORY>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   <FAVORITECATEGORY>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>JoinTracks</label>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
micronsPerPixel = POI.Parameter2; %LateralPixelResolution %old % micronsPerPixel=1.550 %microns per pixel (512x512) BUT image is in 256x256 so reduced by 2   3.102 &#xD;
framesPerSec    = POI.Parameter4; %ti_d SamplingFrequency&#xD;
woundRegion     = PhagoSight.woundRegion ;&#xD;
close all&#xD;
&#xD;
% figure('Position',[950 250 ((s(3)/2)) ((s(4)/2)+200)]); %[ x y Width Height]&#xD;
figure(103);set(gcf,'Name','10 = with labels (numbers) for the tracks','Position',[400 50 ((s(3)/2)+300) ((s(4)/2)+300)]);&#xD;
% plotTracks(handles,2,:,micronsPerPixel,framesPerSec);view(-10,25); %note view(xy,z) %note view z=90 either right in front or back   xy=90 is top view -90 is bottom view&#xD;
plotTracks(handles,2);view(-10,25); %note view(xy,z) %note view z=90 either right in front or back   xy=90 is top view -90 is bottom view&#xD;
selectNeutrophilsM(gcf,handles,woundRegion)&#xD;
pause()&#xD;
&#xD;
trackA=input('FirstTrack? ')&#xD;
trackB=input('SecondTrack? ')&#xD;
&#xD;
handles = joinTwoTracks(handles,trackA,trackB);&#xD;
&#xD;
&#xD;
&#xD;
close all&#xD;
&#xD;
</callback>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Excel After Manipulated</label>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
if handles.rows&gt;500&#xD;
    micronsPerPixel=1.55 ;  %3.102um=1pixel or 1.55um=1pixle if not reduced as is the case in the updated version of Phagosight&#xD;
else&#xD;
    micronsPerPixel=3.102;&#xD;
end;&#xD;
coe=(micronsPerPixel/ti_d); %microns per minute&#xD;
s = strcat(name,'_',inputName);&#xD;
inputWorC=input('Wound (W), (2W),(w), Control (C) Tail?','s');&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
Mp=length(handles.finalLabel);&#xD;
Arr_Tort=Paredes.tortuosity;&#xD;
Arr_Meander=Paredes.meanderRatio;&#xD;
Arr_Mps=max(handles.finalLabel);%Arr_totdist=handles.distanceNetwork.totPerTrack;&#xD;
Arr_avdistpt=avtotalDist;&#xD;
Arr_absv=Paredes.absVel;&#xD;
Arr_staticr=Paredes.staticRatio;&#xD;
Arr_staticf=Paredes.frame_staticRatio;&#xD;
Arr_staticA=handles.Andre.Statictot;&#xD;
Arr_f2b=handles.Andre.f2b;&#xD;
Arr_fwdrA=handles.Andre.fwdtot;&#xD;
Arr_fwdr=handles.distanceNetwork.forwardRatioTot;&#xD;
Arr_bwdrA=handles.Andre.bwdtot;&#xD;
%% Mean&#xD;
Str_Mean={'AbsVel(um/min)','Cell Recruitment','Tortuosity','Meander Ratio','Static Ratio Mp','Static Ratio Fr','Static Ratio A','Fwd:Bwd','Fwd Ratio A','Fwd Ratio','Bwd Ratio A'};&#xD;
Mean_Tort=mean(Arr_Tort);&#xD;
Mean_Meander=mean(Arr_Meander);&#xD;
% Mean_totdist=mean(Arr_totdist)*micronsPerPixel;&#xD;
Mean_avdistpt=mean(Arr_avdistpt)*micronsPerPixel;&#xD;
Mean_absv=mean(Arr_absv)*coe;&#xD;
Mean_staticr=mean(Arr_staticr);&#xD;
Mean_staticf=mean(Arr_staticf);&#xD;
Mean_staticA=mean(Arr_staticA);&#xD;
Mean_f2b=mean(Arr_f2b);&#xD;
Mean_fwdrA=mean(Arr_fwdrA);&#xD;
Mean_fwdr=mean(Arr_fwdr);&#xD;
Mean_bwdrA=mean(Arr_bwdrA);&#xD;
Array_Mean={Mean_absv,Arr_Mps,Mean_Tort,Mean_Meander,Mean_staticr,Mean_staticf,Mean_staticA,Mean_f2b,Mean_fwdrA,Mean_fwdr,Mean_bwdrA};&#xD;
Table_Mean=[Str_Mean;Array_Mean;];&#xD;
%% Std&#xD;
Str_Std={'StdAbsVel','N/A','StdTort','StdMea','StdStaticMP','StdStaticFr','StdStaticA','StdF2B','StdFwdA','StdFwdR','StdBwdA'};&#xD;
Std_Tort=std(Arr_Tort);&#xD;
Std_Meander=std(Arr_Meander);&#xD;
% Std_totdist=std(Arr_totdist)*micronsPerPixel;&#xD;
Std_avdistpt=std(Arr_avdistpt)*micronsPerPixel;&#xD;
Std_absv=std(Arr_absv)*coe;&#xD;
Std_staticr=std(Arr_staticr);&#xD;
Std_staticf=std(Arr_staticf);&#xD;
Std_staticA=std(Arr_staticA);&#xD;
Std_f2b=std(Arr_f2b);&#xD;
Std_fwdrA=std(Arr_fwdrA);&#xD;
Std_fwdr=std(Arr_fwdr);&#xD;
Std_bwdrA=std(Arr_bwdrA);&#xD;
Array_Std={Std_absv,1,Std_Tort,Std_Meander,Std_staticr,Std_staticf,Std_staticA,Std_f2b,Std_fwdrA,Std_fwdr,Std_bwdrA};&#xD;
Table_Std=[Str_Std;Array_Std];&#xD;
%% Big Array&#xD;
STRING={s};&#xD;
STRING_WorC={inputWorC};&#xD;
%Sheet 1 Alternative&#xD;
Table_1=[Table_Mean,Table_Std];&#xD;
Arr_Table1=horzcat([{'Name'};STRING],[{'WorC'};STRING_WorC],[{'Frames'};handles.numFrames],[{'ti_d'};ti_d],[{'t_plate'};t_plate],Table_1);&#xD;
Arr_Table1=Arr_Table1';&#xD;
%Sheet 1&#xD;
Arr_0_Sheet1=horzcat({'Name'},Str_Mean);&#xD;
Arr_1=horzcat(STRING,Array_Mean);&#xD;
Arr_2=horzcat(STRING_WorC,Array_Std);&#xD;
Array_Sheet1=[Arr_1;Arr_2];&#xD;
Array_1F=[Arr_0_Sheet1;Array_Sheet1];&#xD;
%Sheet 2&#xD;
Arr_0_Sheet2=horzcat({'WorC'},{'Name'},{'Frames'},{'ti_d'},{'Plated'},Str_Mean,Str_Std);&#xD;
Arr_1_sheet2=horzcat(Array_Mean);&#xD;
Array_Sheet2=horzcat(STRING_WorC,STRING,[handles.numFrames],[ti_d],[t_plate],Arr_1_sheet2,Array_Std);&#xD;
Array_2F=[Arr_0_Sheet2;Array_Sheet2];&#xD;
%% Save   &#xD;
str_velocityunits='um/min';&#xD;
smat = strcat(s,'.mat');&#xD;
saveExceldir=input('Are we doing David','s');&#xD;
if saveExceldir=='y'&#xD;
    str_tempsave='E:\PhD Paredes Data\Dr. Cheng\Zebrafish\David';&#xD;
else&#xD;
    str_tempsave='C:\Users\AndreDaniel\Documents\SkyDrive\PHD\Prelim\Save';&#xD;
end;&#xD;
cd(str_tempsave)&#xD;
save(s,'Array_1F','Table_Mean','Table_Std','str_velocityunits')%,'-append')&#xD;
%%&#xD;
% figure(1); set(gcf,'name','total distance')          &#xD;
% hist(Arr_totdist,Mp)&#xD;
% axis([0 20 0 Mp])&#xD;
figure(2);set(gcf,'name','Absolute Velocity')&#xD;
hist(Arr_absv,Mp)&#xD;
%% in Wound&#xD;
    Hps_inW=find((handles.distanceNetwork.numHopsInWound)&gt;0);%(handles.distanceNetwork.numHopsExploration&gt;0)&#xD;
    lens_Hps_inW=length(Hps_inW);&#xD;
    Arr_inW_Vel=handles.distanceNetwork.absVelocityExp*coe; %I think this is in wound velocity&#xD;
    Arr_inW_f2bE=handles.Andre.f2bE;%added 12/07/2015&#xD;
    Arr_inW_forR=handles.distanceNetwork.forwardRatioE;&#xD;
    Arr_inW_forA=handles.Andre.fwdE;%added 12/2/2015&#xD;
    Arr_inW_bwdA=handles.Andre.bwdE;%added 12/2/2015&#xD;
    Arr_inW_idleR=handles.distanceNetwork.IdleWoundRatio;&#xD;
    Arr_inW_staticA=handles.Andre.StaticE;%added 12/2/2015&#xD;
    Arr_inW_leaveR=handles.distanceNetwork.LeaveWoundRatio;&#xD;
    Arr_outW_Vel=handles.distanceNetwork.absVelocityTra*coe;&#xD;
    Arr_outW_f2bT=handles.Andre.f2bT;%added 12/07/2015&#xD;
    Arr_outW_forR=handles.distanceNetwork.forwardRatioT;&#xD;
    Arr_outW_forA=handles.Andre.fwdT;%added 12/2/2015;&#xD;
    Arr_outW_bwdA=handles.Andre.bwdT;%added 12/2/2015;&#xD;
    Arr_outW_staticA=handles.Andre.StaticT;%added 12/2/2015&#xD;
    ARR_W={Arr_inW_Vel,Arr_inW_f2bE,Arr_inW_forR,Arr_inW_forA,Arr_inW_bwdA,...&#xD;
        Arr_inW_idleR,Arr_inW_staticA,Arr_inW_leaveR,Arr_outW_Vel,...&#xD;
        Arr_outW_f2bT,Arr_outW_forR,Arr_outW_forA,Arr_outW_bwdA,Arr_outW_staticA};&#xD;
    Str_W={'inW-Vel','inW-Fwd:Bwd','inW-ForwR','inW-ForwA','inW-BwdA','inW-IdleR','inW-StaticA',...&#xD;
        'inW-leaveR','outW-Vel','outW-Fwd:Bwd','outW-ForR','outW-ForA','outW-BwdA','outW-StaticA'};&#xD;
    Arr_0_Sheet3=horzcat({'WorC'},{'tplate'},{'name'},{'Cell Recruitment'},Str_W,Str_W);&#xD;
    clear arr_w&#xD;
    arr_w=0;&#xD;
    clear Array_Ws&#xD;
    if isempty(Hps_inW)==0&#xD;
        for I=1:numel(ARR_W)&#xD;
            Hps_inW=find(isfinite(ARR_W{I})); &#xD;
            a=0;&#xD;
            for i=Hps_inW&#xD;
                a=a+1;&#xD;
                arr_w(a)=ARR_W{I}(i);&#xD;
%                 Array_inW_Velocity(a)=Arr_inW_Vel(i);&#xD;
%                 Array_inW_forR=Arr_inW_forR(i);&#xD;
%                 Array_inW_idleR=Arr_inW_idleR(i);&#xD;
%                 Array_inW_leaveR=Arr_inW_leaveR(i);&#xD;
%                 Array_outW_Vel=Arr_outW_Vel(i);&#xD;
%                 Array_outW_forR=Arr_outW_forR;(i);&#xD;
            end;   &#xD;
%             Mean_inW_Velocity=mean(Array_inW_Velocity)*coe;&#xD;
%             Std_inW_Velocity=std(Array_inW_Velocity)*coe;&#xD;
            Array_Ws_Mean{I}=mean(arr_w);&#xD;
            Array_Ws_Std{I}=std(arr_w);&#xD;
            Array_Ws{I}=arr_w;&#xD;
            clear arr_w&#xD;
        end;&#xD;
        Arr_1_Sheet3=horzcat(STRING_WorC,[t_plate],STRING,[lens_Hps_inW],Array_Ws_Mean,Array_Ws_Std); &#xD;
        Array_3F=[Arr_0_Sheet3;Arr_1_Sheet3];&#xD;
        save(s,'Array_3F','-append')&#xD;
    else&#xD;
    end;&#xD;
&#xD;
%% Combined Excel&#xD;
display(s)&#xD;
display(strcat('Number of Mps: ',num2str(lens_Hps_inW)))&#xD;
pause();&#xD;
if saveExceldir=='y'&#xD;
   str_ExcelFolder='E:\PhD Paredes Data\Dr. Cheng\Zebrafish\David';&#xD;
else&#xD;
  str_ExcelFolder='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\Data\Excel Zebrafish';%'C:\Users\AndreDaniel\Documents\SkyDrive\PHD\Excel';&#xD;
end;&#xD;
cd(str_ExcelFolder)&#xD;
cd(str_ExcelFolder)&#xD;
% file_excel=uigetfile('*.*');&#xD;
if isempty(strfind(name,'mpx'))&#xD;
    file_excel='Prelim_Mps.xlsx';&#xD;
else&#xD;
    file_excel='Prelim_Neut.xlsx';&#xD;
end;&#xD;
[NUM_1,TXT_1,RAW_1]=xlsread(file_excel,1);&#xD;
[NUM_2,TXT_2,RAW_2]=xlsread(file_excel,2);&#xD;
[NUM_3,TXT_3,RAW_3]=xlsread(file_excel,3);&#xD;
%%When STARTING EXCEL FOR FIRST TIME&#xD;
if isempty(TXT_1) &amp;&amp; isempty(TXT_2) &amp;&amp; isempty(TXT_3)&#xD;
%     xlswrite(file_excel,Array_1F,1,'A1')&#xD;
    xlswrite(file_excel,Arr_Table1,1,'A1')&#xD;
    xlswrite(file_excel,Array_2F,2,'A1')&#xD;
&#xD;
   if isempty(Hps_inW)&#xD;
   else&#xD;
%         xlswrite(file_excel,Array_3F,3,'A1')&#xD;
        xlswrite(file_excel,Array_3F',3,'A1')&#xD;
   end;&#xD;
   &#xD;
% %%APPENDING EXCEL FILE &#xD;
else&#xD;
%     ARR_SHEET1=[RAW_1,Array_Sheet1];&#xD;
    ARR_SHEET1=[RAW_1,Arr_Table1(:,2)];&#xD;
    ARR_SHEET2=[RAW_2;Array_Sheet2];&#xD;
    xlswrite(file_excel,ARR_SHEET1,1,'A1')&#xD;
    xlswrite(file_excel,ARR_SHEET2,2,'A1')&#xD;
   if isempty(Hps_inW)&#xD;
   else&#xD;
       %         xlswrite(file_excel,Array_3F,3,'A1')&#xD;
%         ARR_SHEET3=[RAW_3;Arr_1_Sheet3];&#xD;
        ARR_SHEET3=[RAW_3,Arr_1_Sheet3'];&#xD;
        xlswrite(file_excel,ARR_SHEET3,3,'A1')&#xD;
   end;&#xD;
end;&#xD;
%%%%&#xD;
&#xD;
&#xD;
winopen(file_excel)</callback>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>DeleteHopslessthan7-NOT IN WOUND</label>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
micronsPerPixel = POI.Parameter2; %LateralPixelResolution %old % micronsPerPixel=1.550 %microns per pixel (512x512) BUT image is in 256x256 so reduced by 2   3.102 &#xD;
framesPerSec    = POI.Parameter4; %ti_d SamplingFrequency&#xD;
woundRegion     = PhagoSight.woundRegion;&#xD;
% Delete hops less than 5&#xD;
% Hp=hplotTracks.finalNetwork';&#xD;
HpinW= find(handles.distanceNetwork.numHopsInWound'&gt;0);&#xD;
Hp=handles.distanceNetwork.numHops';&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
U2=find(Hp&lt;5);%find hps less than specific number&#xD;
lens_HpinW=length(HpinW);&#xD;
for k=1:lens_HpinW&#xD;
    if isempty(find(U2==HpinW(k)))&#xD;
    else&#xD;
        display(strcat(num2str(HpinW(k)),' is in wound'))&#xD;
        int=find(U2==HpinW(k))&#xD;
        U2(int)=[];&#xD;
    end;&#xD;
end;&#xD;
&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
D2=flipud(U2);&#xD;
lens_D2=length(D2);&#xD;
for i=1:lens_D2&#xD;
    handles=removeOneTrack(handles,D2(i),woundRegion);&#xD;
end;&#xD;
%%--Check&#xD;
display('Check if it works')&#xD;
Hp=handles.distanceNetwork.numHops';&#xD;
lens_Hp=length(hplotTracks.finalNetwork);&#xD;
U2=find(Hp&lt;5);&#xD;
D2=flipud(U2);&#xD;
lens_D2=length(D2);&#xD;
display(U2)&#xD;
%5--Done&#xD;
display('Now save handles')</callback>
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>BreakapartTrack</label>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Break apart Track&#xD;
&#xD;
% Shortcut summary goes here&#xD;
close all&#xD;
s               = POI.Parameter12;&#xD;
woundRegion     = PhagoSight.woundRegion ;&#xD;
&#xD;
% figure('Position',[950 250 ((s(3)/2)) ((s(4)/2)+200)]); %[ x y Width Height]&#xD;
figure(103);set(gcf,'Name','10 = with labels (numbers) for the tracks','Position',[400 50 ((s(3)/2)+300) ((s(4)/2)+300)]);&#xD;
plotTracks(handles,2); view(-10,25);&#xD;
selectNeutrophilsM(gcf,handles,woundRegion)&#xD;
pause()&#xD;
track=input('Track Number? ')&#xD;
trackFrame=input('Track Frame of Deletion? ')&#xD;
&#xD;
handles = breakOneTrack(handles,track,trackFrame);</callback>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>DeleteTracks</label>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
micronsPerPixel = POI.Parameter2; %LateralPixelResolution %old % micronsPerPixel=1.550 %microns per pixel (512x512) BUT image is in 256x256 so reduced by 2   3.102 &#xD;
framesPerSec    = POI.Parameter4; %ti_d SamplingFrequency&#xD;
woundRegion     = PhagoSight.woundRegion;&#xD;
%% --&#xD;
close all&#xD;
figure(101)&#xD;
 plotTracks(handles,5)%normally 2&#xD;
%  plotTracks(handles,5,handles.distanceNetwork.numHops&gt;6);&#xD;
view(45,45)&#xD;
view(20,14)&#xD;
% figure(102)&#xD;
% plotTracks(handles,10);&#xD;
% view(0,90)&#xD;
% figure(103);set(gcf,'Name','5 = highlights shorter tracks');&#xD;
% plotTracks(handles,10,:,micronsPerPixel,framesPerSec);&#xD;
input_delete_track=100;&#xD;
while input_delete_track&gt;0;&#xD;
selectNeutrophilsM(gcf,handles,woundRegion);&#xD;
input_delete_track=input('What track should I delete, "0" to stop ? ')&#xD;
handles=removeOneTrack(handles,input_delete_track,woundRegion);&#xD;
% figure(201)&#xD;
% plotTracks(handles,10);&#xD;
% view(0,90)&#xD;
figure(202);set(gcf,'Name','10 = with labels (numbers) for the tracks');&#xD;
plotTracks(handles,5,:,micronsPerPixel,framesPerSec);&#xD;
 &#xD;
% input_delete=input('Delete Another Track y/n ? ','s')&#xD;
&#xD;
end;&#xD;
&#xD;
% view(6,30)&#xD;
</callback>
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>DeleteALLHps&lt;5</label>
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%% Summary Delete hops less than 5&#xD;
%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
s               = POI.Parameter12; %s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
micronsPerPixel = POI.Parameter2; %LateralPixelResolution %old % micronsPerPixel=1.550 %microns per pixel (512x512) BUT image is in 256x256 so reduced by 2   3.102 &#xD;
framesPerSec    = POI.Parameter4; %ti_d SamplingFrequency&#xD;
woundRegion     = PhagoSight.woundRegion;&#xD;
%--&#xD;
HpinW           = find(handles.distanceNetwork.numHopsInWound'&gt;0);&#xD;
Hp              = handles.distanceNetwork.numHops'; % Hp=hplotTracks.finalNetwork';&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
U2=find(Hp&lt;6);%find hps less than specific number&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
D2=flipud(U2);&#xD;
lens_D2=length(D2);&#xD;
for i=1:lens_D2&#xD;
    handles=removeOneTrack(handles,D2(i),woundRegion);&#xD;
end;&#xD;
%%--Check&#xD;
display('Check if it works')&#xD;
Hp=handles.distanceNetwork.numHops';&#xD;
lens_Hp=length(hplotTracks.finalNetwork);&#xD;
U2=find(Hp&lt;4);&#xD;
D2=flipud(U2);&#xD;
lens_D2=length(D2);&#xD;
display(U2)&#xD;
%5--Done&#xD;
display('Now save handles')</callback>
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <name>Manipulate</name>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   </FAVORITECATEGORY>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   <FAVORITECATEGORY>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zebrafish100-RemoveMovements.  </label>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Create A new node network. I will be redoing what the program already&#xD;
% does for forward ratio and whatnot.  &#xD;
%%Try to change Velocity and BoundaryBox data, shouldn't be too hard.  Then&#xD;
%%See if it will work.  IF not create another handles "AndreHANDLES"  and&#xD;
%%then just redo what they already do.  FwdRatio and BwdRatio should be the&#xD;
%%only difficulty.  The rest will stay the same.  &#xD;
%%Static we will do from scratch anyway.  &#xD;
%%you have to carefully select a Mp that is in everyframe, or atleast&#xD;
%%doesn't skip any frame   &#xD;
%     handles.distMaps.absDistMap   = tempMaps2(1:rowsData,1:colsData,1); &#xD;
%     handles.distMaps.oriDistMap   = tempMaps2(1:rowsData,1:colsData,2); &#xD;
%     handles.distMaps.angleMap     = tempMaps2(1:rowsData,1:colsData,3); &#xD;
%     handles.distMaps.latDistMap   = tempMaps2(1:rowsData,1:colsData,4); &#xD;
%     handles.distMaps.effDistMap   = tempMaps2(1:rowsData,1:colsData,5); &#xD;
%%once corrected these will no longer be as valid as they were before.&#xD;
%%Other than that we are all straight!!!&#xD;
%%woohooooo&#xD;
%%I suggest to do all the editing you need and then last step is to redo&#xD;
%%wound region in a new &#xD;
display('Paused:  Make sure you save handles_Andre',...&#xD;
    'Save Unadultrated version so that you have it just in case you need to go back')&#xD;
pause()&#xD;
handles2=handles;&#xD;
str_Functions_str='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'; %Functions Folder-Upload Functions Andre Created&#xD;
addpath(str_Functions_str);&#xD;
Gold_num=input('Which is the reference Hp?');&#xD;
    hp1=handles.finalNetwork(:,Gold_num);&#xD;
    lens_hp1=length(hp1);&#xD;
    lens=length(handles.nodeNetwork(:,1));&#xD;
    ind=find(handles.nodeNetwork(:,14)==Gold_num); &#xD;
    lens_ind=length(ind);&#xD;
    %ind is hp1&#xD;
    &#xD;
    %%%%%%%%%%%%%%&#xD;
&#xD;
    gold=handles.nodeNetwork(ind(1),:)';&#xD;
    x_gold=handles.nodeNetwork(ind(1),1);&#xD;
    y_gold=handles.nodeNetwork(ind(1),2);&#xD;
    frame_gold=handles.nodeNetwork(ind(1),5);&#xD;
    x_box=handles.nodeNetwork(ind(1),15);&#xD;
    y_box=handles.nodeNetwork(ind(1),16);&#xD;
    a=0;&#xD;
    Movement=[0,0];&#xD;
    boxMovement=[0,0];&#xD;
    Gold_pos=[0,0,0,0,0,0,0,0];&#xD;
    clear x_mBox&#xD;
    clear y_mBox&#xD;
    clear x_move&#xD;
    clear y_move&#xD;
    clear frame_move&#xD;
    for i=1:lens_ind  &#xD;
        %assuming in every frame.  &#xD;
        node=ind(i);&#xD;
        frame_move=handles.nodeNetwork(node,5);&#xD;
        x_move=x_gold-handles.nodeNetwork(node,1);&#xD;
        y_move=y_gold-handles.nodeNetwork(node,2);&#xD;
        x_mBox=x_gold-handles.nodeNetwork(node,15);&#xD;
        y_mBox=y_gold-handles.nodeNetwork(node,16);&#xD;
    %     display('test pass')&#xD;
        Movement(frame_move,1)=x_move;&#xD;
        Movement(frame_move,2)=y_move;&#xD;
        boxMovement(frame_move,1)=x_mBox;&#xD;
        boxMovement(frame_move,2)=y_mBox;&#xD;
 &#xD;
        %Gold_pos records [x_int  y_int  x_box_int  y_box_int]&#xD;
        %This just helps&#xD;
        Gold_pos(frame_move,1)=handles.nodeNetwork(node,1);&#xD;
        Gold_pos(frame_move,2)=handles.nodeNetwork(node,2);&#xD;
        Gold_pos(frame_move,3)=handles.nodeNetwork(node,15);&#xD;
        Gold_pos(frame_move,4)=handles.nodeNetwork(node,16);&#xD;
        Gold_pos(frame_move,5)=x_gold;&#xD;
        Gold_pos(frame_move,6)=y_gold;&#xD;
        Gold_pos(frame_move,7)=frame_move;&#xD;
        Gold_pos(frame_move,8)=node;&#xD;
    end;&#xD;
%     for i=1:lens_ind  &#xD;
%         node=ind(i);&#xD;
%         frame_move=handles.nodeNetwork(node,5);&#xD;
%         x_move=x_gold-handles.nodeNetwork(node,1);&#xD;
%         y_move=y_gold-handles.nodeNetwork(node,2);&#xD;
%         x_mBox=x_gold-handles.nodeNetwork(node,15);&#xD;
%         y_mBox=y_gold-handles.nodeNetwork(node,16);&#xD;
%     %     display('test pass')&#xD;
%         Movement(frame_move,1)=x_move;&#xD;
%         Movement(frame_move,2)=y_move;&#xD;
%         boxMovement(frame_move,1)=x_mBox;&#xD;
%         boxMovement(frame_move,2)=y_mBox;&#xD;
%         %Gold_pos records [x_int  y_int  x_box_int  y_box_int]&#xD;
%         %This just helps&#xD;
%         Gold_pos(frame_move,1)=handles.nodeNetwork(node,1);&#xD;
%         Gold_pos(frame_move,2)=handles.nodeNetwork(node,2);&#xD;
%         Gold_pos(frame_move,3)=handles.nodeNetwork(node,15);&#xD;
%         Gold_pos(frame_move,4)=handles.nodeNetwork(node,16);&#xD;
%         Gold_pos(frame_move,5)=x_gold;&#xD;
%         Gold_pos(frame_move,6)=y_gold;&#xD;
%         Gold_pos(frame_move,7)=frame_move;&#xD;
%     end;&#xD;
clear arr_missed&#xD;
arr_missed=find(Gold_pos(:,7)==0);&#xD;
% for I=length(arr_missed)&#xD;
%     mnod=arr_missed(I);&#xD;
%     mfram=find(handles.node&#xD;
% end;&#xD;
    Movement=[Movement,(1:(length(Movement)))'];&#xD;
    boxMovement=[boxMovement,(1:(length(Movement)))'];&#xD;
%% Make Gold hop into&#xD;
%     for k=2:lens_ind&#xD;
%         node=ind(k);&#xD;
%         x_change=Movement(k,1)+handles.nodeNetwork(node,1);&#xD;
%         y_change=Movement(k,2)+handles.nodeNetwork(node,2);&#xD;
%         handles.nodeNetwork(node,1)=x_change;&#xD;
%         handles.nodeNetwork(node,2)=y_change;&#xD;
%     end;&#xD;
    % &#xD;
    % 	1. handles.nodeNetwork is a matrix of dimensions [number of segmented neutrophils x 31].&#xD;
    % 	1. % Columns [1 - 3] - Position of the centroid [ X  Y  Z]&#xD;
    %                     For example [436.5  77.5    6]&#xD;
    % % Columns [  4  ] - Distance to closest neutrophil&#xD;
    % % Columns [  5  ] - Time Frame&#xD;
    % % Columns [  6  ] - Unique ID of neutrophil&#xD;
    % % Columns [  7  ] - * Parent&#xD;
    %                     The number here designates which node (above) is part of &#xD;
    %                     this track, Parent = 0 no parent, this is the initial  &#xD;
    %                     node of a track.&#xD;
    % % Columns [  8  ] - * Child&#xD;
    %                     The number here designates which node (below) is part of  &#xD;
    %                     this track, Child = 0 no children. &#xD;
    % % Columns [  9  ] - Velocity between present and previous frame&#xD;
    % % Columns [  10 ] - Volume of Neutrophil&#xD;
    % % Columns [  11 ] - Label at time frame as assigned by segmentation&#xD;
    %                     This will be used to concatenate tracks but is not the &#xD;
    %                     definitive label of the track.&#xD;
    % % Columns [  12 ] - Keyhole Region&#xD;
    %                     Which region of the keyhole was used to link nodes &#xD;
    %                     (1 - circle, 2 - wedge).&#xD;
    % % Columns [  13 ] - Track&#xD;
    %                     Number of the track to which it belongs.&#xD;
    % &#xD;
    % % Columns [  14 ] - FinalLabel &#xD;
    %                     This is the label of the track as assigned after &#xD;
    %                     mergers/splits/collisions were detected&#xD;
    % % Columns [15-20] - BoundingBox  &#xD;
    %                     [15 - X_init, 16 - Y_init, 17 - Z_init, &#xD;
    %                     18 - size in X, 19 - size in Y, 20 - size in Z  ]&#xD;
    % % Columns [  26 ] - Volume to surface ratio&#xD;
    % &#xD;
    % % Columns [  27 ] - Sphericity&#xD;
    %                     ((pi * 36* Volume^2)^(1/3))/Area as defined in wikipedia.&#xD;
    % &#xD;
    % % Columns [  28 ] - Number of neighbours at different distance brackets &#xD;
    %                     (0-10,10-20,20-30,30-40,40-50,50-100, 100-...) arranged  &#xD;
    %                     as 0*num_0_10 + 10*num_10_20 + 100*num_20_30, ...&#xD;
    %                     For example:  if a neutrophil has one neutrophil at d=5, &#xD;
    %                     2 neutrophil at d=15 and 3 neutrophil at d=25, and &#xD;
    %                     6 neutrophils at more than 100 pixels then this &#xD;
    %                     column value will be  6000321. &#xD;
    % % Columns [  30 ] - Distance to disappearing track&#xD;
    %                     This column calculates the distance to a track that &#xD;
    %                     finished in the previous time frame. If there are no &#xD;
    %                     tracks that disappeared in the previous frame, the &#xD;
    %                     distance is Inf. &#xD;
    % % Columns [  31 ] - Distance to appearing track&#xD;
    %                     This column calculates the distance to a track that &#xD;
    %                     started in the next time frame. If there are no tracks&#xD;
    %                     that appeared in the next frame, the distance is Inf.&#xD;
    %                     These two last tracks are used to detect neutrophil &#xD;
    %                     collisions. &#xD;
    %                     &#xD;
    %                     &#xD;
    %                     &#xD;
    % &#xD;
    % % Columns [  33 ] - Absolute Distance Per Hop&#xD;
    %                     This column calculates the absolute distance that is&#xD;
    %                     traversed by a neutrophil per hop between time points.&#xD;
    %                                          &#xD;
    % &#xD;
    % % Columns [  34 ] - Number of Hops&#xD;
    %                     This column calculates the number of hops of the track,&#xD;
    %                     i.e. the number of time points it spans.&#xD;
    %                                          &#xD;
    % &#xD;
    % % Columns [  35 ] - Angle Per Hop&#xD;
    %                     This column calculates the orientation angle of each&#xD;
    %                     hop that is done by the neutrophils.&#xD;
    %                                          &#xD;
    % &#xD;
    % % Columns [  36 ] - Lateral Distance Per Hop&#xD;
    %                     This column calculates the lateral distance &#xD;
    %                     (parallel to the wound) that is&#xD;
    %                     traversed by a neutrophil per hop between time points.&#xD;
    %                                          &#xD;
    % &#xD;
    % % Columns [  37 ] - Effective Distance Per Hop&#xD;
    %                     This column calculates the effective distance &#xD;
    %                     (perpendicular to the wound) that is&#xD;
    %                     traversed by a neutrophil per hop between time points.&#xD;
    %                                          &#xD;
%%   &#xD;
handles2=handles;&#xD;
    display('Commencing Track Zebrafish Adjustments')&#xD;
    display('...')&#xD;
    pause(4)&#xD;
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
    for H=1:length(Movement)&#xD;
%         node=ind(J);&#xD;
%         H=handles.nodeNetwork(node,5);%this gives frame of first node&#xD;
        arr_frame=find(handles.nodeNetwork(:,5)==H);&#xD;
        len_numinframe=length(arr_frame);  &#xD;
        for j=1:len_numinframe&#xD;
            &#xD;
            if Movement(H,1)==0;&#xD;
                if H&gt;1&#xD;
                    Movement(H,1)=Movement(H-1,1);&#xD;
                    Movement(H,2)=Movement(H-1,2);&#xD;
                else&#xD;
                end;&#xD;
            else&#xD;
            end;&#xD;
            node=arr_frame(j);&#xD;
            x_change=Movement(H,1)+handles.nodeNetwork(node,1);&#xD;
            y_change=Movement(H,2)+handles.nodeNetwork(node,2);&#xD;
            x_bchange=Movement(H,1)+handles.nodeNetwork(node,15);&#xD;
            y_bchange=Movement(H,2)+handles.nodeNetwork(node,16);&#xD;
        %function so that you don't negative pixel int or too large for&#xD;
        %16bit image&#xD;
            x_change=bit16abs(x_change);&#xD;
            y_change=bit16abs(y_change);&#xD;
            x_bchange=bit16abs(x_bchange);&#xD;
            y_bchange=bit16abs(y_bchange);       &#xD;
        %officially change in nodenetwork&#xD;
            handles.nodeNetwork(node,1)=x_change;&#xD;
            handles.nodeNetwork(node,2)=y_change;&#xD;
            handles.nodeNetwork(node,15)=x_bchange;&#xD;
            handles.nodeNetwork(node,16)=y_bchange;&#xD;
        end;&#xD;
        display(strcat('Frame ',num2str(H), 'adjusted for inadvertant Tail Movement'))&#xD;
    end;&#xD;
    check_movement='yes';&#xD;
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
&#xD;
   %% Correct Velocities&#xD;
% for currentTrack=1:&#xD;
%     Arr_Vel=handles.nodeNetwork(:,9);&#xD;
%  &#xD;
%     arr_label=handles.nodeNetwork(:,handles.finalNetwork(&#xD;
%     </callback>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>WoundRegion-AfterManipulated</label>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
str_Functions_str='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'; %Functions Folder-Upload Functions Andre Created&#xD;
addpath(str_Functions_str);&#xD;
% http://www.phagosight.org/NF/trackingManual4.php&#xD;
ch_PH2      = handles.ChannelDistribution(4);&#xD;
ch_GFP      = round(median(handles.ChannelDistribution(1):handles.ChannelDistribution(3)))&#xD;
ch_PH2      = 4;&#xD;
imagesc(dataR(:,:,ch_GFP))&#xD;
imagesc(dataR(:,:,ch_PH2))&#xD;
woundRegion  = roipoly();&#xD;
%% Once this wound region has been selected it is passed as a variable&#xD;
%% to the following functions&#xD;
handles       = effectiveDistance(handles,woundRegion);&#xD;
disp (handles)&#xD;
%% To calculate the maps&#xD;
handles      = effectiveTracks_Andre(handles,woundRegion);&#xD;
disp (handles)&#xD;
disp (handles.distMaps)&#xD;
%% Viualised with the command "mesh"&#xD;
% mesh(handles.distMaps.oriDistMap)&#xD;
% displayActivationPoint(handles,dataR(:,:,2),woundRegion);&#xD;
% displayActivationPoint(handles,PH2_re,woundRegion);&#xD;
% displayActivationPoint(handles,wounRegion);&#xD;
displayActivationPoint(handles,dataR(:,:,ch_PH2));&#xD;
dataR_WR                         = dataR(:,:,ch_GFP).*(1-imdilate(zerocross(woundRegion),ones(3)));&#xD;
figure();&#xD;
imagesc(dataR_WR)&#xD;
%%%Adjusted 10/30/2015&#xD;
A                               = handles.distMaps.absDistPerHop(1:(handles.numFrames-1),:);&#xD;
handles.distanceNetwork.perHop  = A;&#xD;
handles                         = effectiveTracks_Andre(handles,woundRegion);&#xD;
disp (handles)</callback>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <name>Post Phagosight Zebrafish</name>
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Paredes It</label>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>A={0};%Unique ID per Track&#xD;
B={0};%Unique ID per TimeFrame&#xD;
C={0};%Time Frame per Track&#xD;
D={0};%DistancePer"Hop" per Track&#xD;
E=0; %Total Time Length (Max-Min)&#xD;
V={0};%Volume per Track (MP)&#xD;
HNN={handles.nodeNetwork};&#xD;
Col14=HNN{1}(:,13); %Track  &#xD;
Col5=HNN{1}(:,5); % Time Frame&#xD;
Col7=HNN{1}(:,7);%Parent&#xD;
Col9=HNN{1}(:,9);% velocity&#xD;
Col10=HNN{1}(:,10); %Volume of MP&#xD;
Num_TrackMax=max(Col14);&#xD;
Num_FrameMax=handles.numFrames; %&#xD;
for i=1:Num_TrackMax&#xD;
    a=handles.finalNetwork(:,i); %Sort UinqueID by Track&#xD;
    d=handles.distMaps.absDistPerHop(:,i); %abs Distance per Hop&#xD;
    a(a==0)=[];&#xD;
    len_a=length(a);%     d(d==0)=[]; &#xD;
    A{i}=a;&#xD;
    D{i}=d(1:(len_a-1)); %Note if 0 value is at some ends, then final frame is duplicated --ERROR&#xD;
    clear a&#xD;
    clear d&#xD;
end;&#xD;
for i=1:Num_FrameMax&#xD;
        b=find(Col5==i); %Sort UniqueID by Time Frame&#xD;
        B{i}=b;&#xD;
            clear b&#xD;
end;&#xD;
%% By Time Frame and Volume&#xD;
C={0}; % Time Frame &#xD;
E=0;&#xD;
&#xD;
for J=1:Num_TrackMax&#xD;
    for j=A{J}&#xD;
        c=HNN{1}(j,5);&#xD;
        v=HNN{1}(j,10);&#xD;
    end;&#xD;
    minC=min(c);&#xD;
    maxC=max(c);&#xD;
    C{J}=c;  %Indivual Frames per Unique ID segmented in tracks&#xD;
    V{J}=v;&#xD;
    e=maxC-minC;&#xD;
    E(J)=e; %Andre Real #tot frames in track&#xD;
    V_mean(J)=mean(v);&#xD;
    V_std(J)=std(v);&#xD;
    clear v&#xD;
    clear c&#xD;
    V_radius(J)=((V_mean(J)-V_std(J))*(3/4)*(1/pi))^(1/3);&#xD;
end;&#xD;
Andre.VolPerMp=V_mean;&#xD;
E1=(1:20)';&#xD;
Eweird=handles.distanceNetwork.numHops;&#xD;
E=E';&#xD;
% E_E=[E1,E,Eweird'];&#xD;
%% Edit Values&#xD;
% A={0};%Unique ID per Track&#xD;
% B={0};%Unique ID per TimeFrame&#xD;
% C={0};%Time Frame per Track&#xD;
% D={0};%DistancePer"Hop" per Track&#xD;
% E=0; %Total Time Length (Max-Min)    &#xD;
%% ----------------------------------------Pass1-------------------------------------------------------&#xD;
arr_timediff=0;&#xD;
Arr_TimeDiff={0};&#xD;
Arr_absVelocity={0};&#xD;
ARR_TrackVel=0;&#xD;
G={0};&#xD;
for K=1:Num_TrackMax&#xD;
    display(strcat('Track:',num2str(K)))&#xD;
     len_C=length(C{K});&#xD;
     minC=min(C{K});&#xD;
     maxC=max(C{K});&#xD;
     adp_timediff=(minC:maxC);&#xD;
     len_adp=length(adp_timediff);&#xD;
     &#xD;
        for k=1:length(C{K})&#xD;
            if k==1&#xD;
    %             val_timediff=0;&#xD;
            else&#xD;
                D_cat=C{K}(k-1);&#xD;
                cur=C{K}(k);&#xD;
                val_timediff=cur-D_cat;&#xD;
                arr_timediff(k-1)=val_timediff;&#xD;
            end;&#xD;
&#xD;
        end;&#xD;
        distanceperhop=D{K};&#xD;
        Arr_TimeDiff{K}=arr_timediff';&#xD;
        Arr_absVelocity{K}=distanceperhop./arr_timediff';   &#xD;
        G{K}=[C{K}(2:len_C),Arr_absVelocity{K},D{K},Arr_TimeDiff{K},V{K}(2:len_C)]; &#xD;
        arr_timediff=0;&#xD;
        ARR_TrackVel(K)=(sum(distanceperhop)/E(K)); %#ok&lt;SAGROW&gt;&#xD;
    numHopsasd(K)=len_C;&#xD;
end;&#xD;
%% Create a new handles.finalNetwork&#xD;
&#xD;
Z=[0];&#xD;
F={0};&#xD;
H={0};&#xD;
for L=1:Num_TrackMax&#xD;
    F{L}=vertcat(Z,Arr_absVelocity{L});&#xD;
    H{L}=vertcat(Z,Arr_TimeDiff{L});&#xD;
    minC=min(C{L});&#xD;
    maxC=max(C{L});&#xD;
    nodecount=1;&#xD;
    cc=minC-1;&#xD;
    for l=1:length(C{L})&#xD;
        cc=cc+1;&#xD;
        nodecount=nodecount+1;&#xD;
        aa=find(C{L}==cc);&#xD;
        bb=isempty(aa);&#xD;
        if cc&gt;maxC&#xD;
            Andre.distmap(cc,L)=0;&#xD;
        elseif isempty(aa)&#xD;
            O=ones(H{L}(l),1);&#xD;
            display('empty')&#xD;
            for k=1:H{L}(l)&#xD;
                Andre.distmap(cc,L)=F{L}(l);&#xD;
                cc=cc+1;&#xD;
                nodecount=nodecount+1;&#xD;
            end;&#xD;
            cc=cc-1;&#xD;
            nodecount=nodecount-1;&#xD;
            Phagosight.distmap(cc,L)=D{L}(l-1);&#xD;
            Cheng.distmap(cc,L)=F{L}(l); &#xD;
        else %is not empty&#xD;
            var_catch=F{L}(l);&#xD;
            Andre.distmap(cc,L)=var_catch;&#xD;
            Jun.distmap(cc,L)=var_catch;&#xD;
            Phagosight.distmap(cc,L)=var_catch;&#xD;
            Cheng.distmap(cc,L)=var_catch;&#xD;
&#xD;
        end; &#xD;
    end;&#xD;
    lastNodeFrame(L)=nodecount;&#xD;
end;&#xD;
Andre.numHops=numHopsasd;&#xD;
% CoLNF=[numHopsasd',lastNodeFrame',handles.distanceNetwork.numHops',(1:Num_TrackMax)'];&#xD;
%%%-Phagosight excludes the skips including the final determination point&#xD;
%%%-Andre.distmap gives distance traveled, including assumped average as it&#xD;
%%%was not determined&#xD;
%%%Velocity per Track&#xD;
M=0;&#xD;
for I=1:Num_TrackMax&#xD;
    temp_adm=Andre.distmap(:,I);&#xD;
    temp_adm(temp_adm==0)=[];&#xD;
    Andre.VelPerMp(I)=mean(temp_adm);&#xD;
    temp_pdm=Phagosight.distmap(:,I);&#xD;
    temp_pdm(temp_pdm==0)=[];&#xD;
    Phagosight.VelPerMp(I)=mean(temp_pdm);&#xD;
end;&#xD;
%M=[Andre.VelPerMp',Phagosight.VelPerMp',handles.distanceNetwork.absVelocity'];&#xD;
%M_mean=mean(M);&#xD;
&#xD;
y=V_mean';&#xD;
x=Andre.VelPerMp';&#xD;
% figure(1);&#xD;
% ax=plot(V_mean,Andre.VelPerMp,'O','LineWidth',2,...&#xD;
%                        'MarkerEdgeColor','k',...&#xD;
%                        'MarkerFaceColor','g',...&#xD;
%                        'MarkerSize',10);&#xD;
% title('Velocity vs Volume','FontSize',16)&#xD;
% ylabel('Velocity (frame/pixel)','FontSize',14)&#xD;
% xlabel('Volume (pixel^3)','FontSize',14)&#xD;
% &#xD;
&#xD;
%%%Velocity per Frame&#xD;
N=0;&#xD;
for I=1:Num_FrameMax&#xD;
    temp_adf=Andre.distmap(I,:);&#xD;
    temp_adf(temp_adm==0)=[];&#xD;
    Andre.VelPerFram(I)=mean(temp_adf);&#xD;
    temp_pdf=Phagosight.distmap(I,:);&#xD;
    temp_pdf(temp_pdf==0)=[];&#xD;
    Phagosight.VelPerFram(I)=mean(temp_pdf);&#xD;
end;&#xD;
N=[Andre.VelPerFram',Phagosight.VelPerFram'];&#xD;
N_mean=mean(N);&#xD;
%% Static Ratio&#xD;
clear Arr_StaticMap&#xD;
clear chum&#xD;
Bigger=[0];&#xD;
for I=1:Num_TrackMax&#xD;
%     temp_arr=find(Phagosight.distmap(:,I)&gt;0);&#xD;
    len=length(D{I});&#xD;
    rad=V_radius(I);&#xD;
    for i=1:len&#xD;
        val=D{I}(i);&#xD;
        if val&gt;=rad;&#xD;
%             display('Bigger')&#xD;
            chum(i)=0;&#xD;
        else&#xD;
%             display('Smaller')&#xD;
            chum(i)=1;&#xD;
        end;&#xD;
%         Bigger(a)=Phagosight.distmap(i,I)&gt;V_radius(I)&#xD;
    end;&#xD;
%     display(num2str(I))&#xD;
%     display(chum)&#xD;
    Phagosight.MpStaticMap{I}=chum;&#xD;
    Phagosight.MpStaticRatio(I)=mean(chum);&#xD;
     clear chum&#xD;
end;&#xD;
%%Per Time &#xD;
chum=0;&#xD;
for I=1:Num_FrameMax&#xD;
    temp_arr=find(Phagosight.distmap(I,:)&gt;0);&#xD;
    len=length(temp_arr);&#xD;
    if isempty(temp_arr)&#xD;
        chum=0;&#xD;
    elseif temp_arr==0 &#xD;
        chum=0;&#xD;
    else&#xD;
        for i=1:len&#xD;
            j=temp_arr(i);&#xD;
                rad=V_radius(j);&#xD;
            val=Phagosight.distmap(I,i);&#xD;
            if val&gt;=rad;&#xD;
%                 display('Bigger')&#xD;
                chum(i)=0;&#xD;
            else&#xD;
%                 display('Smaller')&#xD;
                chum(i)=1;&#xD;
            end;&#xD;
    %         Bigger(a)=Phagosight.distmap(i,I)&gt;V_radius(I)&#xD;
        end;&#xD;
    end;&#xD;
%     display(num2str(I))&#xD;
%     display(chum)&#xD;
    Phagosight.FramStaticMap{I}=chum;&#xD;
    Phagosight.FramStaticRatio(I)=mean(chum);&#xD;
     clear chum&#xD;
end;&#xD;
&#xD;
%% Calculate num of Hops - Andreized.  &#xD;
%get the first node&#xD;
%%note current $$ handles.distanceNetwork.numHops doesn't count first frame&#xD;
numTracks=max(handles.finalLabel);&#xD;
arr_totDist=[];&#xD;
numHops=(0);&#xD;
Arr_totDist={0};&#xD;
totalDist=(0);&#xD;
avtotalDist=(0);&#xD;
absVel=(0);&#xD;
dist_nodes=(0);&#xD;
tortuosity=(0);&#xD;
meanderRatio=(0);&#xD;
for currTrack=1:numTracks&#xD;
    %process numHops for averaged blank steps&#xD;
    orig_numHp=handles.distanceNetwork.numHops(currTrack);&#xD;
    node1=handles.finalNetwork(1,currTrack);  %start&#xD;
    node2=handles.finalNetwork((orig_numHp+1),currTrack);&#xD;
    frame1=handles.nodeNetwork(node1,5);&#xD;
    frame2=handles.nodeNetwork(node2,5);&#xD;
    gotcha=diff([frame1 frame2]);&#xD;
    numHops(currTrack)=gotcha;&#xD;
    %process distance and velocity&#xD;
%     Arr_totDist{currTrack}=handles.distMaps.absDistPerHop(1:numHops(currTrack),currTrack);&#xD;
%     arr_totDist=[arr_totDist handles.distMaps.absDistPerHop(1:numHops(currTrack),currTrack)']; &#xD;
    totalDist(currTrack)=sum(handles.distMaps.absDistPerHop(1:numHops(currTrack),currTrack));&#xD;
    avtotalDist(currTrack)=mean((handles.distMaps.absDistPerHop(1:numHops(currTrack),currTrack)));&#xD;
    absVel(currTrack)=totalDist(currTrack)/numHops(currTrack);&#xD;
    %tortosity and meanduring ratio&#xD;
    x_node1=handles.nodeNetwork(node1,1);&#xD;
    y_node1=handles.nodeNetwork(node1,2);&#xD;
    x_node2=handles.nodeNetwork(node2,1);&#xD;
    y_node2=handles.nodeNetwork(node2,2);&#xD;
    dist_nodes(currTrack)=pdist([x_node1,y_node1; x_node2,y_node2],'Euclidean');&#xD;
    tortuosity(currTrack)=totalDist(currTrack)/dist_nodes(currTrack);&#xD;
    meanderRatio(currTrack)=1/tortuosity(currTrack); &#xD;
%     fudgefactor=1.5;&#xD;
%     staticMps=length(find(handles.distMaps.absDistPerHop(1:numHops(currTrack),currTrack)&lt;=fudgefactor));&#xD;
%     staticRatio(currTrack)=num_staticMps/numHops(currTrack);&#xD;
end;&#xD;
%for fudgefactor for static ration&#xD;
% mtotdist=mean(arr_totDist);&#xD;
% stdtotdist=std(arr_totDist);&#xD;
fudgefactor=1/1;%-stdtotdist;&#xD;
Mav=mean(absVel);&#xD;
Std=std(absVel);&#xD;
if fudgefactor&lt;0&#xD;
    fudgefactor=1/1;%(pixel/frame) i.e. (1.55/1.9)&#xD;
else&#xD;
end;&#xD;
staticRatio=(0);&#xD;
for currTrack=1:numTracks   &#xD;
    num_staticMps=length(find(handles.distMaps.absDistPerHop(1:numHops(currTrack),currTrack)&lt;=fudgefactor));&#xD;
    staticRatio(currTrack)=num_staticMps/numHops(currTrack);&#xD;
end;&#xD;
% Paredes.distMap=Andre.distMap;&#xD;
clear Paredes&#xD;
Paredes.totalDist=totalDist;&#xD;
Paredes.absVel=absVel;&#xD;
Paredes.tortuosity=tortuosity;&#xD;
Paredes.meanderRatio=meanderRatio;&#xD;
Paredes.staticRatio=staticRatio;&#xD;
arr_includedMp=0;&#xD;
frame_staticRatio=(0);&#xD;
for currFrame=2:handles.numFrames&#xD;
    arr_currFrame=find(handles.nodeNetwork(:,5)==currFrame);&#xD;
    arr_includedMp=handles.nodeNetwork(arr_currFrame,14);&#xD;
    arr_includedMp(arr_includedMp==0)=[];&#xD;
    arr_includedfram=Andre.distmap(currFrame,arr_includedMp);&#xD;
    num_framstaticMps=length(find(arr_includedfram&lt;=fudgefactor));&#xD;
    frame_staticRatio(currFrame)=num_framstaticMps/length(arr_includedMp);&#xD;
end;&#xD;
    &#xD;
Paredes.frame_staticRatio=frame_staticRatio;&#xD;
%--------------------- Updated meanderRatio 2016-01-29------------------&#xD;
Paredes.twist=sum(totalDist)/sum(dist_nodes);&#xD;
Paredes.mr=sum(dist_nodes)/sum(totalDist);&#xD;
Tweeker=[Paredes.twist;Paredes.mr];&#xD;
%--------------------- Coe---------------------------------------------&#xD;
% Shortcut summary goes here&#xD;
if handles.rows&gt;500&#xD;
    micronsPerPixel=1.55 ;  %3.102um=1pixel or 1.55um=1pixle if not reduced as is the case in the updated version of Phagosight&#xD;
else&#xD;
    micronsPerPixel=3.102;&#xD;
end;&#xD;
coe=(micronsPerPixel/ti_d); %microns per minute</callback>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Zebra_FixOrientation</label>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Orientation&#xD;
%%%%%%%%%%%%%%%%%%%%%ANDRE UPDATE FOR ORIENTATION 11/18/2015&#xD;
%%UPDATE IF WEIRD ERROR TRY SCRIPT THEY ARE NOW TWO DIFFERENT VERSIONS&#xD;
%%BASED ON DIFFERENT NUMHOPS***12/04/2015&#xD;
I=dataR(:,:,ch_PH2);&#xD;
% woundRegion&#xD;
clear Diff_hps&#xD;
clear Coords&#xD;
%%%&#xD;
STATS=regionprops(woundRegion);&#xD;
cc=bwconncomp(woundRegion);&#xD;
STATS2=regionprops(cc);&#xD;
close all&#xD;
figure();&#xD;
imagesc(I); colormap(gray)&#xD;
BW=roipoly();&#xD;
dd=regionprops(BW);&#xD;
close all&#xD;
% figure();&#xD;
% imagesc(I); colormap(gray); hold on;&#xD;
% plot(dd.Centroid(1),dd.Centroid(2),'or',...&#xD;
%     'LineWidth',50)&#xD;
% plot(coords(1,1),coords(1,2),'oc','LineWidth',50)&#xD;
&#xD;
    [H]                                 = hough(woundRegion);&#xD;
    peaks                               = houghpeaks(H, 1);&#xD;
    woundAngle                          = pi*(0+(180-peaks(2)))/180;&#xD;
    &#xD;
numTracks = size(handles.distanceNetwork.perHop,2);&#xD;
  &#xD;
    %First detect which regions of the track are before first visit to the wound&#xD;
    DN=zeros(33);&#xD;
    fbwd=zeros(32);&#xD;
    sr=zeros(32);&#xD;
    const=(1/1);%(pixel/frame)(1.55/frame);&#xD;
    nconst=-(1/1);%(pixel/frame);&#xD;
    clear numhp_fbwd numhp_fbwdT numhp_fbwdE&#xD;
    clear Diff_hps Diff_hpsT Diff_hpsE&#xD;
    clear fwd_hps fwd_hpsT fwd_hpsE&#xD;
    clear bwd_hps bwd_hpsT bwd_hpsE&#xD;
    clear Dist_nodes Dist_nodesT Dist_nodesE&#xD;
    clear static_hps static_hpsT static_hpsE&#xD;
    clear Static_hps Static_hpsE Static_hpsT&#xD;
    clear dist_nodes&#xD;
    clear Forward_Hps Forward_HpsT Forward_HpsE&#xD;
    countE=0;&#xD;
    countT=0;&#xD;
    for currTrack = 1:numTracks&#xD;
        coords=[0];&#xD;
        %find how long is the track&#xD;
        lastNodeT                       = handles.distanceNetwork.numHops(currTrack);&#xD;
       &#xD;
        %to determine if a point of a track is within the wound, get the index for the wound and the&#xD;
        %index for the track nodes and compare them with ismember&#xD;
        indexWound                      = find (woundRegion);&#xD;
        tempIndex                       = sub2ind([handles.rows handles.cols],round(handles.nodeNetwork(handles.finalNetwork(1:lastNodeT,currTrack),1)),round(handles.nodeNetwork(handles.finalNetwork(1:lastNodeT,currTrack),2)));&#xD;
        inWound                         = (ismember(tempIndex,indexWound));&#xD;
        %x&amp;y coordinates of each node in each track. Separated by {}&#xD;
        xcoord=handles.nodeNetwork(handles.finalNetwork(1:(lastNodeT+1),currTrack),1);&#xD;
        ycoord=handles.nodeNetwork(handles.finalNetwork(1:(lastNodeT+1),currTrack),2);&#xD;
        coords=[ycoord,xcoord];&#xD;
 %%NOTE &#xD;
 %%NOTE&#xD;
 %%NOTE TO PHAGEOSIGHT EDITOR YOU LIST FIRST AS XCOORD, BUT YOU ARE&#xD;
 %%WRONG!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&#xD;
        Coords{currTrack}=coords;&#xD;
        col_E=handles.explorationNetwork(:,currTrack);&#xD;
        colE= col_E(col_E~=0);&#xD;
        col_T=handles.translationNetwork(:,currTrack);&#xD;
        colT= col_T(col_T~=0);&#xD;
        col_F=handles.finalNetwork(:,currTrack);&#xD;
        colF= col_F(col_F~=0);         &#xD;
   %%% To Determine idx for E &amp;T&#xD;
       posE=[0];&#xD;
       countC=0;&#xD;
       for h=1:length(col_E)&#xD;
           if col_E(h)&gt;0&#xD;
               countC=countC+1;&#xD;
            abc=find(col_F==col_E(h));&#xD;
            posE(countC)=abc;&#xD;
           else&#xD;
%            elseif h==numel(col_E)&#xD;
&#xD;
            &#xD;
           end;&#xD;
       end;&#xD;
       find_1E=find(posE==1);&#xD;
       if isempty(find_1E)&#xD;
            diff_posE=posE;&#xD;
       else&#xD;
            diff_posE=posE;&#xD;
            diff_posE(find_1E)=[]; %have to eliminate 1 since we are looking at diff&#xD;
       end;&#xD;
       checkE=find(diff(posE)~=1);&#xD;
       if isempty(checkE)   &#xD;
       else&#xD;
           display('We have a leave an come back in wound region')&#xD;
       end;&#xD;
       PosE{currTrack}=posE;&#xD;
       Diff_posE{currTrack}=diff_posE;&#xD;
   %%Total Fwd Ratio&#xD;
        for i=1:length(Coords{currTrack})&#xD;
                x_node1=Coords{currTrack}(i,1);&#xD;
                y_node1=Coords{currTrack}(i,2);&#xD;
                x_node2=dd.Centroid(1);&#xD;
                y_node2=dd.Centroid(2);&#xD;
            dist_nodes(i)=pdist([x_node1,y_node1; x_node2,y_node2],'Euclidean');  &#xD;
            &#xD;
        end; &#xD;
        clear coords&#xD;
        Dist_hps{currTrack}=dist_nodes;&#xD;
        Diff_hps{currTrack}=((diff(dist_nodes))*-1);%%%we added this -1**&#xD;
    %%Exploration&#xD;
        if handles.distanceNetwork.numHopsInWound==0&#xD;
                countE=1;&#xD;
                Diff_hpsE{countE}=NaN;&#xD;
                fwd_hpsE{countE}=NaN;&#xD;
                bwd_hpsE{countE}=NaN;&#xD;
                F2Be(countE)=NaN;&#xD;
                numhp_fbwdE(countE)=NaN;&#xD;
                static_hpsE{countE}=NaN;&#xD;
                Static_HpsE(countE)=NaN;&#xD;
                Forward_HpsE(countE)=NaN;&#xD;
                Backward_HpsE(countE)=NaN;&#xD;
        else&#xD;
            diff_numHopE=handles.distanceNetwork.numHopsExploration(currTrack)-1; %WHY AM I SUBTACTING 1??????&#xD;
            if handles.distanceNetwork.numHopsExploration(currTrack)==0&#xD;
                D_hpsE{currTrack}=0;&#xD;
                F_hpsE{currTrack}=0;&#xD;
            else&#xD;
                %%%No need to count an E&#xD;
                D_hpsE{currTrack}=Diff_hps{currTrack}(diff_posE-1);&#xD;
                F_hpsE{currTrack}=find(D_hpsE{currTrack}&gt;const); %fwd hps&#xD;
                %%%%%%%%%%%%%%%%%%%&#xD;
                countE=countE+1;&#xD;
                Diff_hpsE{countE}=Diff_hps{currTrack}(diff_posE-1);&#xD;
                fwd_hpsE{countE}=find(Diff_hpsE{countE}&gt;const);&#xD;
                bwd_hpsE{countE}=find(-const&gt;Diff_hpsE{countE});&#xD;
                F2Be(countE)=length(fwd_hpsE{countE})/length(bwd_hpsE{countE});&#xD;
                numhp_fbwdE(countE)=length(fwd_hpsE{countE})+length(bwd_hpsE{countE});&#xD;
                static_hpsE{countE}=find(const&gt;=abs(Diff_hpsE{countE}));&#xD;
                Static_HpsE(countE)=length(find(const&gt;=abs(Diff_hpsE{countE})))/(diff_numHopE+1);%%%clearly no Need since I add 1 here. Silly Andre&#xD;
                Forward_HpsE(countE)=length(fwd_hpsE{countE})/numhp_fbwdE(countE);&#xD;
                Backward_HpsE(countE)=length(bwd_hpsE{countE})/numhp_fbwdE(countE);&#xD;
            end;&#xD;
        end;&#xD;
    %%Translation &#xD;
        diff_numHopT=handles.distanceNetwork.numHopsTranslation(currTrack)-1;&#xD;
        if handles.distanceNetwork.numHopsTranslation(currTrack)==0&#xD;
           D_hpsT{currTrack}=0;&#xD;
           F_hpsT{currTrack}=0;&#xD;
        elseif handles.distanceNetwork.numHopsExploration(currTrack)==0&#xD;
            %%%%%%%%%%%%%%%% 2016-01-12 Check&#xD;
            D_hpsT{currTrack}=Diff_hps{currTrack};%diff(dist_nodes); 2016-01-12 made this chage because of * -1&#xD;
            F_hpsT{currTrack}=find(D_hpsT{currTrack}&gt;const);&#xD;
            %%%%%%%%%%%%%%%%%End&#xD;
            countT=countT+1;&#xD;
            Diff_hpsT{countT}=Diff_hps{currTrack};%diff(dist_nodes); 2016-01-12 --make this change because *-1 &#xD;
            fwd_hpsT{countT}=find(Diff_hpsT{countT}&gt;const);&#xD;
            bwd_hpsT{countT}=find(-const&gt;Diff_hpsT{countT});&#xD;
            F2Bt(countT)=length(fwd_hpsT{countT})/length(bwd_hpsT{countT});&#xD;
            numhp_fbwdT(countT)=length(fwd_hpsT{countT})+length(bwd_hpsT{countT});&#xD;
            static_hpsT{countT}=find(const&gt;=abs(Diff_hpsT{countT}));&#xD;
            Static_HpsT(countT)=length(find(const&gt;=abs(Diff_hpsT{countT})))/(diff_numHopT);&#xD;
            Forward_HpsT(countT)=length(fwd_hpsT{countT})/numhp_fbwdT(countT);&#xD;
            Backward_HpsT(countT)=length(bwd_hpsT{countT})/numhp_fbwdT(countT);&#xD;
        else&#xD;
            diff_hpsT=Diff_hps{currTrack};%diff(dist_nodes); 2016-01-12 made this chage because of * -1&#xD;
            diff_hpsT(diff_posE-1)=[];&#xD;
            countT=countT+1;&#xD;
            Diff_hpsT{countT}=diff_hpsT;&#xD;
            %%%%%%%%%% 2016-01-12 Check&#xD;
            D_hpsT{currTrack}=diff_hpsT;&#xD;
            F_hpsT{currTrack}=find(diff_hpsT&gt;const);&#xD;
            %%%%%%%%%%End&#xD;
            fwd_hpsT{countT}=find(Diff_hpsT{countT}&gt;const);&#xD;
            bwd_hpsT{countT}=find(-const&gt;Diff_hpsT{countT});&#xD;
            F2Bt(countT)=length(fwd_hpsT{countT})/length(bwd_hpsT{countT});&#xD;
            numhp_fbwdT(countT)=length(fwd_hpsT{countT})+length(bwd_hpsT{countT});&#xD;
            static_hpsT{countT}=find(const&gt;=abs(Diff_hpsT{countT}));&#xD;
            Static_HpsT(countT)=length(find(const&gt;=abs(Diff_hpsT{countT})))/(diff_numHopT);&#xD;
            Forward_HpsT(countT)=length(fwd_hpsT{countT})/numhp_fbwdT(countT);&#xD;
            Backward_HpsT(countT)=length(bwd_hpsT{countT})/numhp_fbwdT(countT);&#xD;
        end;&#xD;
     %%Total&#xD;
        diff_size=length(Diff_hps{currTrack});&#xD;
        fwd_hps{currTrack}=find(Diff_hps{currTrack}&gt;const);&#xD;
        fwd_size{currTrack}=length(fwd_hps{currTrack});&#xD;
        bwd_hps{currTrack}=find(-const&gt;Diff_hps{currTrack});&#xD;
        bwd_size{currTrack}=length(bwd_hps{currTrack});&#xD;
        numhp_fbwd(currTrack)=length(fwd_hps{currTrack})+length(bwd_hps{currTrack});&#xD;
        F2B(currTrack)=length(fwd_hps{currTrack})/length(bwd_hps{currTrack});&#xD;
        static_hps{currTrack}=find(const&gt;=abs(Diff_hps{currTrack}));&#xD;
        Static_Hps(currTrack)=length(find(const&gt;=abs(Diff_hps{currTrack})))/(lastNodeT+1);&#xD;
        Forward_Hps(currTrack)=length(fwd_hps{currTrack})/numhp_fbwd(currTrack);&#xD;
        Backward_Hps(currTrack)=length(bwd_hps{currTrack})/numhp_fbwd(currTrack);&#xD;
        Dist_nodes{currTrack}=dist_nodes;&#xD;
        &#xD;
&#xD;
        clear dist_nodes      &#xD;
            %Both Ploting (1) &amp; (2) Work FYI,if you want to see.&#xD;
        %(1)&#xD;
%         figure(currTrack*10);&#xD;
% %         imagesc(woundRegion); hold on;&#xD;
%         imagesc(I); colormap(gray); hold on;&#xD;
%         plot(ycoord,xcoord,'r*')&#xD;
        %(2)&#xD;
%         for i=1:length(Coords{1})&#xD;
%             plot(Coords{1}(i,1),Coords{1}(i,2),'r*')&#xD;
%         end;&#xD;
&#xD;
    end;  &#xD;
%%%%%%%%2016-01-15 Sum and Average Distance&#xD;
Did=[Diff_hps{:}]'; %culminate all diff into one array&#xD;
DF=Did(find(Did&gt;1));%only take larger than 1 values &#xD;
DB=Did(find(Did&lt;-1));%only take smaller than -1 values&#xD;
DidE=[Diff_hpsE{:}]'; %culminate all diff into one array&#xD;
DFe=DidE(find(DidE&gt;1));%only take larger than 1 values &#xD;
DBe=DidE(find(DidE&lt;-1));%only take smaller than -1 values&#xD;
DidT=[Diff_hpsT{:}]'; %culminate all diff into one array&#xD;
DFt=DidT(find(DidT&gt;1));%only take larger than 1 values &#xD;
DBt=DidT(find(DidT&lt;-1));%only take smaller than -1 values&#xD;
&#xD;
%%%%%%%%End 2016-01-15 update&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    &#xD;
%%%%%%%%2015-12-18 Dr. Cheng meeting on new Fwd:Bwd&#xD;
hps_size=handles.distanceNetwork.numHops'&#xD;
fwd_size=fwd_size';&#xD;
bwd_size=bwd_size';&#xD;
FTB=length([fwd_hps{:}])/length([bwd_hps{:}]);    &#xD;
ForR=length([fwd_hps{:}])/sum(length([bwd_hps{:}])+length([fwd_hps{:}]));  &#xD;
FTBt=length([fwd_hpsT{:}])/length([bwd_hpsT{:}]);      &#xD;
FTBe=length([fwd_hpsE{:}])/length([bwd_hpsE{:}]); &#xD;
%%%%%%%%%End 2015-12-18 update%%%%%%%%%%%%%%%%%%&#xD;
%% Add to handles&#xD;
if isfield(handles,'Andre')&#xD;
    handles= rmfield(handles,{'Andre'});  &#xD;
end    &#xD;
Forward_Hps(isnan(Forward_Hps))=[];&#xD;
Forward_HpsE(isnan(Forward_HpsE))=[];&#xD;
Forward_HpsT(isnan(Forward_HpsT))=[];&#xD;
%F2B&#xD;
F2B(F2B==0)=[];&#xD;
    F2B(isinf(F2B))=[];&#xD;
    F2B(isnan(F2B))=[];&#xD;
F2Be(F2Be==0)=[];&#xD;
    F2Be(isinf(F2Be))=[];&#xD;
        F2Be(isnan(F2Be))=[];&#xD;
F2Bt(F2Bt==0)=[];&#xD;
    F2Bt(isinf(F2Bt))=[];&#xD;
        F2Bt(isnan(F2Bt))=[];&#xD;
Backward_Hps(isnan(Backward_Hps))=[];&#xD;
Backward_HpsE(isnan(Backward_HpsE))=[];&#xD;
Backward_HpsT(isnan(Backward_HpsT))=[];&#xD;
Backward_HpsT(isnan(Backward_HpsT))=[];&#xD;
Static_Hps(isnan(Static_Hps))=[];&#xD;
Static_HpsE(isnan(Static_HpsE))=[];&#xD;
if isempty(Static_HpsT)&#xD;
    Static_HpsT=(NaN);&#xD;
    &#xD;
else&#xD;
    Static_HpsT(isnan(Static_HpsT))=[];&#xD;
end;&#xD;
handles.Andre.fwdtot=Forward_Hps;&#xD;
handles.Andre.fwdE=Forward_HpsE;&#xD;
handles.Andre.fwdT=Forward_HpsT;&#xD;
handles.Andre.f2b=F2B;&#xD;
handles.Andre.f2bT=F2Bt;&#xD;
handles.Andre.f2bE=F2Be;&#xD;
handles.Andre.bwdtot=Backward_Hps;&#xD;
handles.Andre.bwdE=Backward_HpsE;&#xD;
handles.Andre.bwdT=Backward_HpsT;&#xD;
%Note this is only per Track and might be unnecessary considering the&#xD;
%previous one I have.  &#xD;
handles.Andre.Statictot=Static_Hps;&#xD;
handles.Andre.StaticE=Static_HpsE;&#xD;
handles.Andre.StaticT=Static_HpsT;&#xD;
&#xD;
Prelim=[FTB;FTBe;FTBt;sum(DF)*coe;sum(DFe)*coe;sum(DFt)*coe;sum(DB)*coe;sum(DBe)*coe;sum(DBt)*coe];&#xD;
&#xD;
    </callback>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>DeleteTrack_ Andre</label>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
str_Functions_str='C:\Users\AndreDaniel\Documents\Dropbox\LLIULM\MATLAB\Image Processing\Fun'; %Functions Folder-Upload Functions Andre Created&#xD;
addpath(str_Functions_str);&#xD;
% Shortcut summary goes here&#xD;
close all&#xD;
figure(101)&#xD;
 plotTracks(handles,5)%normally 2&#xD;
%  plotTracks(handles,5,handles.distanceNetwork.numHops&gt;6);&#xD;
view(45,45)&#xD;
view(20,14)&#xD;
% figure(102)&#xD;
% plotTracks(handles,10);&#xD;
% view(0,90)&#xD;
% figure(103);set(gcf,'Name','5 = highlights shorter tracks');&#xD;
% plotTracks(handles,10,:,micronsPerPixel,framesPerSec);&#xD;
input_delete_track=100;&#xD;
while input_delete_track&gt;0;&#xD;
selectNeutrophilsM(gcf,handles,woundRegion);&#xD;
input_delete_track=input('What track should I delete, "0" to stop ? ')&#xD;
handles=removeOneTrack_Andre(handles,input_delete_track,woundRegion);&#xD;
% figure(201)&#xD;
% plotTracks(handles,10);&#xD;
% view(0,90)&#xD;
figure(202);set(gcf,'Name','10 = with labels (numbers) for the tracks');&#xD;
plotTracks(handles,5,:,micronsPerPixel,framesPerSec);&#xD;
 &#xD;
% input_delete=input('Delete Another Track y/n ? ','s')&#xD;
&#xD;
end;&#xD;
&#xD;
% view(6,30)</callback>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>JoinTracks_Andre</label>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
% Shortcut summary goes here&#xD;
&#xD;
&#xD;
close all&#xD;
s=get(0,'ScreenSize'); % s= [ 1 1 1920 1080]  --&gt; Width-x-(1920) &amp; Height-y-(1080)&#xD;
% figure('Position',[950 250 ((s(3)/2)) ((s(4)/2)+200)]); %[ x y Width Height]&#xD;
figure(103);set(gcf,'Name','10 = with labels (numbers) for the tracks','Position',[800 250 ((s(3)/2)+200) ((s(4)/2)+200)]);&#xD;
plotTracks(handles,2);&#xD;
selectNeutrophilsM(gcf,handles,woundRegion)&#xD;
&#xD;
&#xD;
trackA=input('FirstTrack? ')&#xD;
trackB=input('SecondTrack? ')&#xD;
&#xD;
handles = joinTwoTracks_Andre(handles,trackA,trackB);</callback>
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   </FAVORITECATEGORY>
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   



   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   





   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   




   



















   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   




   
   
   
   
   
   
   



   
   
   
   

   
   
   



   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   <FAVORITECATEGORY>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>ZebrafishTrack#</label>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%- Update 2017-11-17&#xD;
%% Define Variables &#xD;
woundRegion     = PhagoSight.woundRegion;   &#xD;
figure(); &#xD;
plotTracks(handles,10)&#xD;
view(20,45)&#xD;
selectNeutrophilsM(gcf,handles,woundRegion)&#xD;
&#xD;
&#xD;
%                   [-14:-1]    Will be the same options as the positive ones but with X,Y,Z&#xD;
%                   [1:14]      Will plot the tracks with the following options for X,Y,T&#xD;
%                                       1  = highlights longer (in distance) branches&#xD;
%                                       2  = highlights faster branches&#xD;
%                                       3  = highlights longer (in number of frames) branches&#xD;
%                                       4  = highlights shorter branches&#xD;
%                                       5  = highlights slower branches&#xD;
%                                       6  = highlights smaller branches&#xD;
%                                       7  = discard branches with small total distance, i.e. 30% of upper half average distance&#xD;
%                                       8  = discard branches with less than 3 nodes&#xD;
%                                       9  = plot ONLY those branches crossing the present Frame&#xD;
%                                       10 = with labels (numbers) for the tracks&#xD;
%                                       11 = all tracks in green&#xD;
%                                       12 = all tracks in red&#xD;
%                                       13 = top in red, bottom in green&#xD;
%                                       14 = top in green, bottom in red&#xD;
%                                       15 = plot [x,volume,time] as type 1&#xD;
%                                       16 = plot [y,volume,time] as type 1&#xD;
%                                       17 = Merge into plot [x,volume,time] one colour per handle&#xD;
%                                       18 = Merge into plot [y,volume,time] one colour per handle&#xD;
%                                       19 = Merge several separate handles, p</callback>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>joinMultipleTracks</label>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Upper Case B</icon>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
handles=joinMultipleTracks(handles)</callback>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>WoundRegion-ToEdit</label>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% http://www.phagosight.org/NF/trackingManual4.php&#xD;
ch_PH2=handles.ChannelDistribution(4);&#xD;
ch_GFP=round(median(handles.ChannelDistribution(1):handles.ChannelDistribution(3)))&#xD;
&#xD;
ch_PH2=handles.ChannelDistribution(4);&#xD;
ch_GFP=round(median(handles.ChannelDistribution(1):handles.ChannelDistribution(3)))&#xD;
OriginalImg = valsPH2{num_zpos}{2};&#xD;
ch_PH2=4;&#xD;
figure(101)&#xD;
 plotTracks(handles,5)%normally 2&#xD;
%  plotTracks(handles,5,handles.distanceNetwork.numHops&gt;6);&#xD;
view(45,45)&#xD;
view(20,14)&#xD;
woundRegion  = roipoly();&#xD;
&#xD;
%% Once this wound region has been selected it is passed as a variable&#xD;
%% to the following functions&#xD;
handles       = effectiveDistance(handles,woundRegion);&#xD;
disp (handles)&#xD;
&#xD;
%% To calculate the maps&#xD;
handles      = effectiveTracks(handles,woundRegion);&#xD;
disp (handles)&#xD;
&#xD;
disp (handles.distMaps)&#xD;
&#xD;
%% Viualised with the command "mesh"&#xD;
% mesh(handles.distMaps.oriDistMap)&#xD;
&#xD;
% displayActivationPoint(handles,dataR(:,:,2),woundRegion);&#xD;
% displayActivationPoint(handles,PH2_re,woundRegion);&#xD;
% &#xD;
% displayActivationPoint(handles,wounRegion);&#xD;
displayActivationPoint(handles,dataR(:,:,ch_PH2));&#xD;
&#xD;
dataR_WR = dataR(:,:,ch_GFP).*(1-imdilate(zerocross(woundRegion),ones(3)));&#xD;
figure();&#xD;
imagesc(dataR_WR)&#xD;
</callback>
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Reset Handles</label>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% % Shortcut summary goes here&#xD;
% handles=handlesPreW;&#xD;
% &#xD;
% % % % Remove boarder&#xD;
% currAxPos = get(gca,'position');&#xD;
% if currAxPos(end) ==1&#xD;
%     set(gca,'position',[  0.1300    0.1100    0.7750    0.8150 ]);axis on&#xD;
% else&#xD;
%     set(gca,'position',[0 0 1 1 ]);axis off&#xD;
% end&#xD;
% clear currAxPos&#xD;
%%%%&#xD;
 handles=rmfield(handles,{'explorationNetwork','translationNetwork','distMaps','inWoundNetwork','inWound'});&#xD;
 &#xD;
 handles.distanceNetwork= rmfield(handles.distanceNetwork,{'forwardRatioTot','forwardRatioTot2'});&#xD;
 &#xD;
 display(handles)</callback>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Remove Frame</label>
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
&#xD;
% % % Remove boarder&#xD;
currAxPos = get(gca,'position');&#xD;
if currAxPos(end) ==1&#xD;
    set(gca,'position',[  0.1300    0.1100    0.7750    0.8150 ]);axis on&#xD;
else&#xD;
    set(gca,'position',[0 0 1 1 ]);axis off&#xD;
end&#xD;
clear currAxPos&#xD;
&#xD;
% colormap(gray)</callback>
      
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>WoundRegionNoResize</label>
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here</callback>
      
      
      
      
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>GoldenTime</label>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Shortcut summary goes here&#xD;
% 1-8Straight forward&#xD;
% 9A Save New_Handles _Andre &#xD;
% 9B. if necessary  Identify indigenous spot and use it for correcting  --&gt; New Wound region&#xD;
% 10 Paredesit&#xD;
% 11. Fix Zebrafish Orientation (i have no idea what --so far been rehighlighting wound region)&#xD;
% 12.  Edit (after manipulated if need to delete or join now that corrected)&#xD;
% 13.  Repeat 9 and 10&#xD;
% 14. Excel after manipulation&#xD;
%First check the boundaries&#xD;
[time,track]=size(handles.inWound);&#xD;
%determine the 2.5 hours after wounding.  &#xD;
&#xD;
GT=round((150-t_plate)/ti_d);  %GT=goldentime&#xD;
if GT&gt;=time&#xD;
    GT=time;&#xD;
    display(strcat(num2str(GT),'_ exceeds ',' _', num2str(time)))&#xD;
else&#xD;
end;  &#xD;
&#xD;
inWoundCount=0;&#xD;
beat=0;&#xD;
for i=1:track&#xD;
    place=handles.inWound(1:GT,i)';&#xD;
   beat=sum(place);&#xD;
   if beat&gt;0&#xD;
       inWoundCount=inWoundCount+1;&#xD;
   else&#xD;
   end;&#xD;
&#xD;
end;&#xD;
disp(inWoundCount)&#xD;
Totallength=(ti_d*handles.numFrames)+t_plate&#xD;
imaginglength=(ti_d*handles.numFrames)&#xD;
P=name5</callback>
      
      
      
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Delete_Z f</label>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>% Delete a Z from the &#xD;
%%%This is to Eliminate a Z stack that is hindering image processing&#xD;
%%%Specific for phagosight saved format  T001...T002 style...&#xD;
&#xD;
&#xD;
driveinput=input('External (y)  Desktop (n)  Labtop anything else','s');&#xD;
if driveinput =='y'&#xD;
    maincd='E:\PhD Paredes Data\Dr. Cheng\Zebrafish\Processed Data';&#xD;
    cd(maincd)&#xD;
elseif driveinput=='n'&#xD;
else&#xD;
end;&#xD;
&#xD;
gotcd=uigetdir();&#xD;
cd(gotcd)&#xD;
[pa, name, ext] = fileparts(gotcd);&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
    chn_str='TexRed';&#xD;
    zstack_str='1';&#xD;
    disp('Are you sure??')&#xD;
    disp(chn_str)&#xD;
    disp(zstack_str)&#xD;
    pause()&#xD;
%%%%%%%%%%COPY DIR &#xD;
cd(pa)&#xD;
copydir_str=strcat(name,'-removed_z',zstack_str);&#xD;
mkdir(copydir_str)&#xD;
cd(copydir_str);&#xD;
copycd_str=cd;&#xD;
cd(pa)&#xD;
copyfile(name,copycd_str)&#xD;
gotcd=copycd_str;&#xD;
cd(gotcd)&#xD;
[pa, name, ext] = fileparts(gotcd);&#xD;
%%%%%%%%%END COPY DIR&#xD;
cd(pa)&#xD;
new_deldir=strcat(name,'_z',zstack_str);&#xD;
mkdir(new_deldir)&#xD;
cd(new_deldir)&#xD;
del_cd=cd;&#xD;
cd(gotcd)&#xD;
lensdir=length(dir);&#xD;
thisdir=dir;&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
clear delimg&#xD;
for J=3:lensdir&#xD;
    cd(thisdir(J).name)&#xD;
    indir=dir;&#xD;
    strdel=strcat('*',chn_str,'*z100',zstack_str,'*');&#xD;
    delimg=dir(strdel);&#xD;
    movefile(delimg.name,del_cd)&#xD;
    cd(gotcd)&#xD;
    clear delimg&#xD;
end;&#xD;
</callback>
      
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <FAVORITE>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <label>Combine_Z_f</label>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <icon>Standard icon</icon>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <callback>%%%This is to Combine Z stack that is hindering image processing&#xD;
%%%Specific for phagosight saved format  T001...T002 style...&#xD;
&#xD;
&#xD;
driveinput=input('External (y)  Desktop (n)  Labtop anything else','s');&#xD;
if driveinput =='y'&#xD;
    maincd='E:\PhD Paredes Data\Dr. Cheng\Zebrafish\Processed Data';&#xD;
    cd(maincd)&#xD;
elseif driveinput=='n'&#xD;
else&#xD;
end;&#xD;
&#xD;
gotcd=uigetdir();&#xD;
cd(gotcd)&#xD;
[pa, name, ext] = fileparts(gotcd);&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
    chn_str='TexRed';&#xD;
    disp('Are you sure??')&#xD;
    disp(chn_str)&#xD;
    pause()&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%COPY DIR&#xD;
cd(pa)&#xD;
combinedir_str=strcat(name,'-combine');&#xD;
combinedir_str_flourchn=strcat(combinedir_str);&#xD;
mkdir(combinedir_str)&#xD;
cd(combinedir_str);&#xD;
combinePh2cd_str=cd;&#xD;
mkdir('Fluorescent Channel')&#xD;
cd(chn_str)&#xD;
combinecd_str=cd;%folder of combined dir&#xD;
% copyfile(name,combinecd_str)&#xD;
%%%%%%%%%END COPY DIR&#xD;
cd(gotcd)&#xD;
lensdir=length(dir);&#xD;
thisdir=dir;&#xD;
&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
    cd(thisdir(3).name)&#xD;
    indir=dir;&#xD;
    strcomb=strcat('*',chn_str,'*z100*');&#xD;
    combimg=dir(strcomb);&#xD;
    znum=length(combimg);&#xD;
cd(gotcd)&#xD;
&#xD;
for J=3:lensdir&#xD;
    cd(thisdir(J).name)&#xD;
    indir=dir;&#xD;
%Ph2 Channel%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
    strPh2=strcat('*Ph2*z1001*');&#xD;
    combPh2img=dir(strPh2);&#xD;
    copyfile(combPh2img.name,combinePh2cd_str)&#xD;
%Flourescent Channel%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%&#xD;
    strcomb=strcat('*',chn_str,'*z100*');&#xD;
    combimg=dir(strcomb);&#xD;
    znum=length(combimg);&#xD;
    AI=0;&#xD;
        for i=1:znum&#xD;
            comb_arr{i}=imread(combimg(i).name);&#xD;
            AI=AI+comb_arr{i};            &#xD;
        end;&#xD;
    str_I=strcat(thisdir(J).name,'-',chn_str,'.TIF');&#xD;
    cd(combinecd_str)&#xD;
    imwrite(AI/3,str_I,'Compression','none','Resolution',1);%,'BitDepth',16);&#xD;
%     movefile(combimg.name,del_cd)&#xD;
    cd(gotcd)&#xD;
&#xD;
end;</callback>
      
      
      
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         <editable>true</editable>
   
   
   
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      </FAVORITE>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <name>Zebrafish</name>
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   </FAVORITECATEGORY>

























   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   



   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   


   
   
   
   
   
   
   
   
   
   

   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   









   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   
   

























</FAVORITESROOT>